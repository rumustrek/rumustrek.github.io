<!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>RUMUS OTOMATIS (terbatas) - RAN</title><style>/* === UNTUK FITUR LENGKAP + KODE TERSUSUN RAPI HANYA TERSEDIA DI VERSI PRO === */ *{margin: 0;padding: 0;box-sizing: border-box;font-family: 'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}html,body{min-height: 100%;overflow-x: hidden;}body{overscroll-behavior-y: auto;overscroll-behavior-x: none;}body{background: linear-gradient(135deg,#f8fafc 0%,#f1f5f9 100%);min-height: 100vh;padding: 10px;display: flex;align-items: flex-start;justify-content: center;overflow-x: hidden;transition: all 0.3s ease;position: relative;}body.dark-theme{background: linear-gradient(135deg,#2d3748 0%,#1a202c 100%);color: #e2e8f0;}.main-container{max-width: 1200px;width: 100%;margin: 0 auto;background: white;border-radius: 15px;padding: 20px;box-shadow: 0 12px 24px rgba(0,0,0,0.12);transition: box-shadow 0.3s ease;position: relative;z-index: 1;overflow: visible;}body.dark-theme .main-container{background: #2d3748;box-shadow: 0 12px 24px rgba(0,0,0,0.2);}.header{text-align: center;margin-bottom: 20px;padding-bottom: 15px;border-bottom: 1px solid #e9ecef;}.limited-header{text-align: center;}.limited-header .header-top{display:flex;flex-direction:column;gap:4px;align-items:center;}.limited-header .title-row{display:flex;align-items:center;justify-content:center;gap:10px;flex-wrap:wrap;}.limited-header .title-left{display:flex;align-items:center;gap:8px;}.limited-header .header-icon{font-size:22px;line-height:1;transform: translateY(1px);filter: drop-shadow(0 4px 10px rgba(15,23,42,.14));}.limited-header h1{margin:0;font-size:28px;letter-spacing:.3px;font-weight:800;}.limited-header .header-upgrade{color:#ef4444;font-weight:700;display:flex;align-items:center;justify-content:center;gap:6px;font-size: 13px;}.limited-header .lock-icon{font-size:16px;}.limited-header h1{margin:0; font-size: 30px; letter-spacing: .5px;}.badge-terbatas{background: linear-gradient(135deg,#ef4444,#f97316);color:#fff;padding: 6px 12px;border-radius: 999px;font-weight: 800;font-size: 11px;letter-spacing: .7px;box-shadow: 0 8px 14px rgba(239,68,68,.16);white-space: nowrap;}.header-subtitle{color:#64748b;font-size: 13px;line-height: 1.25;text-align:center;max-width: 720px;}.header-upgrade{color:#ef4444;font-size: 14px;font-weight: 800;}body.dark-theme .header-subtitle{color:#a0aec0;}body.dark-theme .header-upgrade{color:#fca5a5;}body.dark-theme .header{border-bottom-color: #4a5568;}.header h1{color: #2d3748;margin-bottom: 8px;font-size: 2.2rem;font-weight: 700;display: flex;align-items: center;justify-content: center;gap: 12px;transition: all 0.3s ease;}body.dark-theme .header h1{color: #e2e8f0;}.subtitle{text-align: center;color: #718096;font-size: 15px;line-height: 1.5;max-width: 700px;margin: 0 auto;transition: all 0.3s ease;}body.dark-theme .subtitle{color: #a0aec0;}.theme-toggle{position:fixed;top:12px;right:12px;margin:0;z-index:1000000;}.theme-toggle button{width:44px;height:44px;padding:0;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;gap:0;background:linear-gradient(135deg,#4a5568,#718096);color:#fff;border:none;cursor:pointer;font-size:18px;font-weight:700;box-shadow:0 6px 18px rgba(102,126,234,0.25);transition:transform .15s ease,box-shadow .15s ease,opacity .15s ease;}.theme-toggle button:hover{transform:translateY(-1px);box-shadow:0 10px 24px rgba(102,126,234,0.35);}.theme-toggle button:active{transform:translateY(0);}body.dark-theme .theme-toggle button{background:linear-gradient(135deg,#4a5568,#718096);}#themeText{display:none !important;}.color-kepala{color: #e74c3c !important; font-weight: 600;}.color-ekor{color: #2ecc71 !important; font-weight: 600;}.color-default{color: inherit !important;}.main-grid{display: grid;grid-template-columns: 1fr 1.2fr;gap: 20px;margin-bottom: 20px;position: relative;z-index: 2;max-width: 100%;overflow: visible;contain: none;}.main-grid > *{min-width: 0;}@media (max-width: 1100px){.main-grid{grid-template-columns: 1fr;}}.input-section,.output-section{background: #f8f9fa;padding: 20px;border-radius: 12px;border: 1px solid #e9ecef;transition: all 0.3s ease;position: relative;z-index: 3;overflow: visible;min-height: 0;}body.dark-theme .input-section,body.dark-theme .output-section{background: #4a5568;border-color: #718096;}.section-title{color: #2d3748;margin-bottom: 15px;font-size: 18px;font-weight: bold;display: flex;align-items: center;gap: 8px;transition: all 0.3s ease;}body.dark-theme .section-title{color: #e2e8f0;}.data-input{margin-bottom: 15px;}.data-input textarea{width: 100%;height: 140px;padding: 12px;border: 1px solid #e2e8f0;border-radius: 10px;font-size: 14px;resize: vertical;margin-bottom: 12px;font-family: 'Courier New',monospace;transition: all 0.3s ease;background: white;color: #333;line-height: 1.4;}body.dark-theme .data-input textarea{background: #2d3748;border-color: #718096;color: #e2e8f0;}.data-input textarea:focus{border-color: #667eea;outline: none;box-shadow: 0 0 0 2px rgba(102,126,234,0.1);}body.dark-theme .data-input textarea:focus{box-shadow: 0 0 0 2px rgba(102,126,234,0.2);}.data-stats{display: grid;grid-template-columns: repeat(4,1fr);gap: 8px;margin-bottom: 12px;}@media (max-width: 768px){.data-stats{grid-template-columns: repeat(4,1fr);}}.stat-box{background: white;padding: 6px;border-radius: 6px;text-align: center;border: 1px solid #e2e8f0;transition: all 0.3s ease;box-shadow: 0 2px 4px rgba(0,0,0,0.05);}body.dark-theme .stat-box{background: #2d3748;border-color: #4a5568;}.stat-label{font-size: 12px;color: #718096;margin-bottom: 4px;font-weight: 600;text-transform: uppercase;letter-spacing: 0.4px;}body.dark-theme .stat-label{color: #a0aec0;}.stat-value{font-size: 15px;font-weight: bold;color: #2d3748;}body.dark-theme .stat-value{color: #e2e8f0;}.progress-container{margin-bottom: 15px;}.progress-bar{width: 100%;height: 8px;background: #e0e0e0;border-radius: 4px;margin-top: 4px;overflow: hidden;position: relative;}body.dark-theme .progress-bar{background: #4a5568;}.progress-fill{height: 100%;background: linear-gradient(90deg,#4CAF50,#8BC34A);width: 0%;transition: width 0.3s ease;border-radius: 4px;}.progress-text{display: flex;justify-content: space-between;font-size: 12px;color: #718096;margin-bottom: 4px;}body.dark-theme .progress-text{color: #a0aec0;}.controls{display: grid;grid-template-columns: repeat(3,minmax(0,1fr));gap: 10px;margin-bottom: 10px;}.controls .control-group{min-width: 0;}.control-group{display: flex;flex-direction: column;}.control-group label{font-size: 12px;color: #2d3748;margin-bottom: 6px;font-weight: 600;display: flex;align-items: center;gap: 4px;user-select: none;}body.dark-theme .control-group label{color: #e2e8f0;}.control-group input,.control-group select{padding: 6px 8px;border: 1px solid #e2e8f0;border-radius: 6px;font-size: 12px;background: white;color: #333;transition: all 0.3s ease;font-family: inherit;height: 34px;}body.dark-theme .control-group input,body.dark-theme .control-group select{background: #2d3748;border-color: #718096;color: #e2e8f0;}.control-group input:focus,.control-group select:focus{border-color: #667eea;outline: none;box-shadow: 0 0 0 2px rgba(102,126,234,0.1);}body.dark-theme .control-group input:focus,body.dark-theme .control-group select:focus{box-shadow: 0 0 0 2px rgba(102,126,234,0.2);}.control-input{background: #fff;border: 1px solid #e2e8f0;border-radius: 6px;padding: 0 10px;display: flex;align-items: center;gap: 10px;height: 34px;min-height: 34px;}body.dark-theme .control-input{background: #2d3748;border-color: #718096;color: #e2e8f0;}.checkbox-input{cursor: pointer;}.controls .control-input.checkbox-input input[type="checkbox"],.full-width .control-input.checkbox-input input[type="checkbox"]{width: 16px;height: 16px;margin: 0;flex: 0 0 auto;cursor: pointer;}.controls .control-input.checkbox-input span,.full-width .control-input.checkbox-input span{font-size: 12px;font-weight: 600;color: #2d3748;line-height: 1.2;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;flex: 1;cursor: pointer;user-select: none;}body.dark-theme .controls .control-input.checkbox-input span,body.dark-theme .full-width .control-input.checkbox-input span{color: #e2e8f0;}.full-width{width: 100%;margin-top: 10px;margin-bottom: 15px;display: block;}.full-width .control-group{width: 100%;}.full-width .control-input{width: 100%;}.digit-selection{background: #fff;border: 1px solid #e2e8f0;border-radius: 10px;padding: 12px;margin-bottom: 15px;}body.dark-theme .digit-selection{background: #2d3748;border-color: #718096;}.digit-selection h3{margin: 0 0 10px 0;font-size: 13px;font-weight: 700;color: #2d3748;letter-spacing: 0.4px;text-align: center;}body.dark-theme .digit-selection h3{color: #e2e8f0;}.mistik-grid{display: grid;grid-template-columns: repeat(5,minmax(0,1fr));gap: 10px;align-items: stretch;}.mistik-item{width: 100%;display: inline-flex;align-items: center;justify-content: center;gap: 8px;padding: 6px 6px;border: 1.5px solid #e5e7eb;background: #f8fafc;border-radius: 12px;box-shadow: 0 1px 0 rgba(0,0,0,.03),0 8px 18px rgba(0,0,0,.06);cursor: pointer;user-select: none;white-space: nowrap;transition: transform .05s ease,border-color .15s ease,box-shadow .15s ease;}.mistik-item:hover{border-color: #cbd5e1;box-shadow: 0 1px 0 rgba(0,0,0,.03),0 10px 22px rgba(0,0,0,.08);}.mistik-item:active{transform: translateY(1px);}.mistik-item input[type="checkbox"]{width: 16px;height: 16px;margin: 0;flex: 0 0 auto;accent-color: #2563eb;}.mistik-item span{font-size: 15px;font-weight: 800;color: #111827;letter-spacing: 0.2px;}body.dark-theme .mistik-item{background: #1f2937;border-color: #374151;box-shadow: 0 1px 0 rgba(0,0,0,.15),0 10px 24px rgba(0,0,0,.35);}body.dark-theme .mistik-item:hover{border-color: #4b5563;}body.dark-theme .mistik-item span{color: #e5e7eb;}.button-group{display: grid;grid-template-columns: repeat(2,1fr);gap: 10px;margin-top: 10px;margin-bottom: 15px;}@media (max-width: 768px){.button-group{grid-template-columns: repeat(2,1fr);}.btn-search{grid-column: 1 / -1;}}@media (max-width: 480px){.button-group{grid-template-columns: repeat(2,1fr);}.btn-search{grid-column: 1 / -1;}}.action-button{padding: 12px 14px;border: none;border-radius: 8px;font-size: 13px;font-weight: 600;cursor: pointer;transition: all 0.3s;display: flex;align-items: center;justify-content: center;gap: 6px;color: white;min-height: 45px;}.action-button:hover:not(:disabled){transform: translateY(-2px);box-shadow: 0 4px 10px rgba(0,0,0,0.12);}.action-button:active:not(:disabled){transform: translateY(-1px);}.action-button:disabled{opacity: 0.5;cursor: not-allowed;transform: none !important;box-shadow: none !important;}.btn-search{background: #ff3333; color: #fff; grid-column: 1 / -1;}.btn-stop{background: #7c3aed; color: #fff;grid-column: span 1;}.btn-continue{background: #2196F3; color: #fff;}.btn-reset{background: #6b7280; color: #fff;}.btn-summary{background: #ff3333; color: #fff;}.btn-copy-selected{background: #7c3aed; color: #fff;}.btn-copy-normal{background: #7c3aed; color: #fff;}.btn-copy-multi{background: #7c3aed; color: #fff;}body.dark-theme .btn-copy-multi{background: #7c3aed; color: #fff;}.btn-clear{background: #6b7280; color: #fff;}.btn-clear-output{background: #7c3aed; color: #fff;}.btn-copy{background: #7c3aed; color: #fff;}.btn-copy-multi{background: #7c3aed; color: #fff;}.auto-continue-checkbox{display: flex;align-items: center;gap: 8px;margin: 15px 0;padding: 12px;background: white;border-radius: 8px;border: 1px solid #e2e8f0;transition: all 0.3s ease;}body.dark-theme .auto-continue-checkbox{background: #2d3748;border-color: #4a5568;}.auto-continue-checkbox input[type="checkbox"]{width: 16px;height: 16px;accent-color: #4CAF50;cursor: pointer;}.auto-continue-checkbox label{font-size: 12px;color: #2d3748;font-weight: 600;cursor: pointer;flex: 1;user-select: none;}body.dark-theme .auto-continue-checkbox label{color: #e2e8f0;}.status-info{background: #e3f2fd;border: 1px solid #2196F3;border-radius: 10px;padding: 15px;margin-top: 15px;font-size: 12px;line-height: 1.5;color: #0d47a1;transition: all 0.3s ease;}body.dark-theme .status-info{background: #2d3748;border-color: #667eea;color: #e2e8f0;}.info-line{display: flex;justify-content: space-between;margin-bottom: 6px;padding-bottom: 6px;border-bottom: 1px solid rgba(255,255,255,0.1);}body.dark-theme .info-line{border-bottom-color: rgba(255,255,255,0.05);}.info-label{color: #1976D2;font-weight: 600;min-width: 120px;}body.dark-theme .info-label{color: #90caf9;}.info-value{font-weight: bold;text-align: right;flex: 1;}.info-warning{color: #f44336; font-weight: bold;}.info-success{color: #4CAF50; font-weight: bold;}.result-display{background: #1a202c;color: #e2e8f0;padding: 18px;border-radius: 10px;font-family: 'Consolas','Courier New',monospace;white-space: pre;line-height: 1.4;border: 1px solid #2d3748;font-size: 15px;overflow-y: auto;height: 500px;margin-bottom: 13px;}.result-display::-webkit-scrollbar{width: 8px;}.result-display::-webkit-scrollbar-track{background: #2d3748; border-radius: 4px;}.result-display::-webkit-scrollbar-thumb{background: #4a5568; border-radius: 4px;}.result-display::-webkit-scrollbar-thumb:hover{background: #718096;}body.dark-theme .result-display{background: #1a202c;border-color: #4a5568;}.result-table-container{margin-top: 12px;max-height: 350px;overflow-y: auto;border: 1px solid #e2e8f0;border-radius: 8px;background: #fff;}body.dark-theme .result-table-container{background: #2d3748;border-color: #4a5568;}.result-table-container table{width: 100%;border-collapse: collapse;font-size: 13px;}.result-table-container th,.result-table-container td{padding: 6px 8px;text-align: center;border-bottom: 1px solid #e2e8f0;}body.dark-theme .result-table-container th,body.dark-theme .result-table-container td{border-bottom-color: #4a5568;color: #e2e8f0;}.result-table-container th{background: #f1f5f9;font-weight: 700;position: sticky;top: 0;z-index: 1;}body.dark-theme .result-table-container th{background: #4a5568;}.result-table-container input[type="checkbox"]{width: 16px;height: 16px;accent-color: #2563eb;}.result-table-empty{text-align: center;padding: 20px;color: #888;font-style: italic;}.output-buttons{display: grid;grid-template-columns: 1fr 1fr;gap: 10px;}.output-buttons .btn-summary{grid-column: 1 / -1;}@media (max-width: 768px){.output-buttons{grid-template-columns: repeat(2,1fr);}}@media (max-width: 480px){.output-buttons{grid-template-columns: repeat(2,1fr);}.output-buttons .btn-summary{grid-column: 1 / -1;}}.notification{position: fixed;top: 10px;left: 50%;transform: translateX(-50%);background: linear-gradient(135deg,#4CAF50,#2E7D32);color: white;padding: 12px 18px;border-radius: 10px;box-shadow: 0 8px 25px rgba(0,0,0,0.2);z-index: 999999;opacity: 0;font-weight: 600;display: flex;align-items: center;justify-content: center;gap: 8px;font-size: 13px;min-width: unset;max-width: calc(100% - 20px);text-align: center;border-left: 4px solid #1B5E20;transition: opacity 0.25s ease;pointer-events: none;margin: 0 auto;contain: paint;isolation: isolate;will-change: opacity,transform;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;}.notification.show{opacity: 1;pointer-events: auto;}.notification.hide{opacity: 0;}.notification.error{background: linear-gradient(135deg,#f44336,#c62828);border-left-color: #b71c1c;}.notification.warning{background: linear-gradient(135deg,#FF9800,#EF6C00);border-left-color: #E65100;}.notification.info{background: linear-gradient(135deg,#2196F3,#1565C0);border-left-color: #0D47A1;}.notification.success{background: linear-gradient(135deg,#4CAF50,#2E7D32);border-left-color: #1B5E20;}.notification::after{content: '';position: absolute;bottom: 0;left: 0;width: 100%;height: 3px;background: rgba(255,255,255,0.4);border-radius: 0 0 10px 10px;transform: scaleX(1);transform-origin: left;}.notification.show::after{animation: progressBar 5s linear forwards;}@keyframes progressBar{from{transform: scaleX(1);}to{transform: scaleX(0);}}@media (max-width: 768px){.notification{max-width: calc(100% - 20px);padding: 10px 14px;font-size: 12px;top: 10px;gap: 6px;}}@media (max-width: 480px){.notification{top: 10px;left: 50%;right: auto;transform: translateX(-50%);min-width: unset;width: auto;max-width: calc(100% - 20px);padding: 10px 12px;font-size: 12px;gap: 6px;}}.footer{text-align: center;margin-top: 20px;padding-top: 15px;border-top: 1px solid #e9ecef;color: #718096;font-size: 12px;line-height: 1.5;}body.dark-theme .footer{border-top-color: #4a5568;color: #a0aec0;}.version{font-weight: bold;color: #667eea;font-size: 13px;}body.dark-theme .version{color: #90caf9;}@media (max-width: 768px){body{padding: 8px;}.main-container{padding: 15px;border-radius: 12px;}.header h1{font-size: 1.8rem;}.controls{grid-template-columns: repeat(2,1fr);}.input-section,.output-section{padding: 15px;}.result-display{height: 500px;font-size: 13px;}}@media (max-width: 480px){.controls{grid-template-columns: 1fr;}.header h1{font-size: 1.5rem;}.data-stats{grid-template-columns: 1fr;}.button-group{grid-template-columns: 1fr;}.btn-search,.btn-stop{grid-column: span 1;}}.hidden{display: none !important;}.output-buttons{display: grid;grid-template-columns: 1fr 1fr;gap: 12px;margin-top: 16px;}.output-buttons .btn-summary{grid-column: 1 / -1;}#resultOutput{margin-bottom: 14px;}#formulaTableWrap{margin-top: 12px;margin-bottom: 10px;}#liveFindingsWrap{margin-bottom: 22px;}#liveFindings{margin-bottom: 22px;}.hasil-lengkap-title{margin-top: 26px;margin-bottom: 14px;}#resultOutput{margin-top: 12px;}.estimation-status{margin-top: 12px;padding: 10px 14px;background: #f8f9fa;border-radius: 8px;border-left: 3px solid #4CAF50;font-size: 12px;line-height: 1.4;transition: all 0.3s ease;animation: fadeIn 0.5s ease;}body.dark-theme .estimation-status{background: #2d3748;border-left-color: #4CAF50;color: #e2e8f0;}.estimation-status strong{color: #2d3748;}body.dark-theme .estimation-status strong{color: #e2e8f0;}.estimation-status small{opacity: 0.8;font-size: 0.9em;}@keyframes fadeIn{from{opacity: 0; transform: translateY(-5px);}to{opacity: 1; transform: translateY(0);}}.locked-output-wrapper{display: flex;align-items: center;justify-content: center;min-height: 560px;padding: 20px;}.locked-output-card{display: inline-block;max-width: 900px;width: 100%;background: linear-gradient(135deg,rgba(30,41,59,.98) 0%,rgba(15,23,42,.98) 100%);border: 2px solid rgba(148,163,184,.3);border-radius: 16px;padding: 24px;color: #e2e8f0;box-shadow: 0 12px 40px rgba(0,0,0,.4);animation: fadeInScale 0.4s ease;}@keyframes fadeInScale{from{opacity: 0; transform: scale(0.95);}to{opacity: 1; transform: scale(1);}}.locked-output-icon{font-size: 48px;text-align: center;margin-bottom: 16px;filter: drop-shadow(0 4px 12px rgba(239,68,68,.5));}.locked-output-title{font-weight: 900;font-size: 20px;letter-spacing: 1px;text-align: center;margin-bottom: 12px;background: linear-gradient(135deg,#ef4444,#f97316);-webkit-background-clip: text;-webkit-text-fill-color: transparent;background-clip: text;}.locked-output-subtitle{font-size: 14px;opacity: .92;text-align: center;margin-bottom: 20px;line-height: 1.5;}.locked-output-features{background: rgba(15,23,42,.6);border-radius: 12px;padding: 16px 20px;margin-bottom: 20px;}.locked-output-features-title{font-weight: 800;font-size: 13px;margin-bottom: 12px;color: #fbbf24;display: flex;align-items: center;gap: 8px;}.locked-output-features ul{margin: 0;padding: 0 0 0 20px;list-style: none;}.locked-output-features li{font-size: 13px;opacity: .95;margin-bottom: 8px;position: relative;padding-left: 24px;line-height: 1.4;}.locked-output-features li:before{content: '‚úì';position: absolute;left: 0;color: #10b981;font-weight: 900;font-size: 16px;}.locked-output-cta{display: flex;gap: 12px;flex-wrap: wrap;justify-content: center;}.locked-output-btn{text-decoration: none;display: inline-flex;align-items: center;justify-content: center;gap: 8px;padding: 12px 20px;border-radius: 12px;font-weight: 900;font-size: 13px;cursor: pointer;border: none;transition: all 0.3s ease;}.locked-output-btn-wa{background: linear-gradient(135deg,#25D366,#128C7E);color: #071a12;box-shadow: 0 4px 12px rgba(37,211,102,.3);}.locked-output-btn-wa:hover{transform: translateY(-2px);box-shadow: 0 6px 16px rgba(37,211,102,.4);}.locked-output-btn-info{background: linear-gradient(135deg,#3b82f6,#2563eb);color: white;box-shadow: 0 4px 12px rgba(59,130,246,.3);}.locked-output-btn-info:hover{transform: translateY(-2px);box-shadow: 0 6px 16px rgba(59,130,246,.4);}.locked-output-footer{text-align: center;margin-top: 16px;padding-top: 16px;border-top: 1px solid rgba(148,163,184,.2);font-size: 11px;opacity: .7;}body.dark-theme .locked-output-card{background: linear-gradient(135deg,rgba(30,41,59,.98) 0%,rgba(15,23,42,.98) 100%);}.locked-output-wrapper,.locked-output-card,.locked-output-card *{box-sizing: border-box;}.locked-output-card{overflow: hidden;}.locked-output-subtitle,.locked-output-features,.locked-output-features li,.locked-output-footer{word-break: break-word;overflow-wrap: anywhere;}.locked-output-features ul{padding-left: 0;margin: 0;}.locked-output-features li{padding-left: 22px;}.locked-output-cta{width: 100%;}.locked-output-btn{flex: 1 1 240px;max-width: 320px;}@media (max-width: 520px){.locked-output-wrapper{min-height: 320px; padding: 14px;}.locked-output-card{padding: 18px; border-radius: 14px;}.locked-output-icon{font-size: 42px; margin-bottom: 12px;}.locked-output-title{font-size: 18px; margin-bottom: 10px;}.locked-output-subtitle{font-size: 13px; margin-bottom: 16px;}.locked-output-features{padding: 14px 14px;}.locked-output-features li{font-size: 12px; margin-bottom: 7px;}.locked-output-btn{width: 100%; max-width: 100%;}}.output-empty-state{display: flex;align-items: center;justify-content: center;min-height: 400px;padding: 20px;}.output-empty-card{text-align: center;max-width: 400px;padding: 30px;opacity: 0.6;}.output-empty-icon{font-size: 64px;margin-bottom: 16px;opacity: 0.5;}.output-empty-text{font-size: 14px;color: #94a3b8;line-height: 1.5;}body.dark-theme .output-empty-text{color: #64748b;}.result-display,.result-table-container{-webkit-overflow-scrolling:touch;overscroll-behavior:contain;}</style></head><body><!-- UNTUK FITUR LENGKAP + KODE TERSUSUN RAPI HANYA TERSEDIA DI VERSI PRO --><div class="main-container"><div class="header limited-header"><div class="header-top"><div class="title-row"><div class="title-left"><span class="header-icon" aria-hidden="true">üîç</span><h1>RUMUS OTOMATIS</h1></div><span class="badge-terbatas">VERSI TERBATAS</span></div><div class="header-subtitle">Hanya mendukung target <b>KEPALA</b> &amp; <b>EKOR</b> | Digit <b>4+</b> | Mistik dasar</div><div class="header-upgrade"><span class="lock-icon" aria-hidden="true">üîí</span> Upgrade ke <b>PRO</b>: <b>WA 082306374484</b></div></div></div><div class="notification" id="notification"></div><div class="theme-toggle"><button id="themeButton"><span id="themeIcon">üåô</span><span id="themeText">Mode Gelap</span></button></div><div class="main-grid"><div class="input-section"><div class="section-title">üì• INPUT DATA</div><div class="data-input"><textarea id="inputNumbers" placeholder="Masukkan angka 4D (satu per baris)"></textarea><div class="data-stats"><div class="stat-box"><div class="stat-label">DATA</div><div class="stat-value" id="dataCount">0</div></div><div class="stat-box"><div class="stat-label">HASIL</div><div class="stat-value" id="foundCount">0</div></div><div class="stat-box"><div class="stat-label">KOMBINASI</div><div class="stat-value" id="formulaCount">0</div></div><div class="stat-box"><div class="stat-label">PROSES</div><div class="stat-value" id="processedCount">0</div></div></div><div class="progress-container"><div class="progress-text"><span>Progress</span><span id="progressPercent">0%</span></div><div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div></div></div><!-- UNTUK FITUR LENGKAP + KODE TERSUSUN RAPI HANYA TERSEDIA DI VERSI PRO --><div class="controls"><div class="control-group"><label>üìÖ Hari Prediksi</label><input type="text" id="daysToPredict" value="20" pattern="[0-9]*" maxlength="3" title="1-200 hari"></div><div class="control-group"><label>üî¢ Digit Prediksi</label><input type="text" id="digitCount" value="4" pattern="[0-9]*" maxlength="2" title="1-12"></div><div class="control-group"><label>üéØ Target Prediksi</label><select id="targetType"><option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ#SPESIFIK</option><option value="A">AS (Ribuan) #PRO</option><option value="C">COP (Ratusan) #PRO</option><option value="K">KEPALA (Puluhan)</option><option value="E">EKOR (Satuan)</option><option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ#ANGKA IKUT</option><option value="AC">AC (2D Depan) #PRO</option><option value="CK">CK (2D Tengah) #PRO</option><option value="KE" selected>KE (2D Belakang)</option><option value="CB">CB (4D Lengkap) #PRO</option><option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ#JUMLAH ON</option><option value="JAC">JUMLAH AC (A+C) #PRO</option><option value="JCK">JUMLAH CK (C+K) #PRO</option><option value="J">JUMLAH KE (K+E) #PRO</option><option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ#SELISIH ON</option><option value="JSAC">SELISIH AC (A-C) #PRO</option><option value="JSCK">SELISIH CK (C-K) #PRO</option><option value="JS">SELISIH KE (K-E) #PRO</option><option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ#SHIO ON</option><option value="SAC">SHIO AC (dari AC) #PRO</option><option value="SCK">SHIO CK (dari CK) #PRO</option><option value="SKE">SHIO KE (dari KE) #PRO</option><option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ#LEMAH SPESIFIK</option><option value="LA">LEMAH AS (LA) #PRO</option><option value="LC">LEMAH COP (LC) #PRO</option><option value="LK">LEMAH KEPALA (LK) #PRO</option><option value="LE">LEMAH EKOR (LE) #PRO</option><option value="LJ">LEMAH JUMLAH (LJ) #PRO</option><option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ#LEMAH ANGKA IKUT</option><option value="LAC">LEMAH AC (LAC) #PRO</option><option value="LCK">LEMAH CK (LCK) #PRO</option><option value="LKE">LEMAH KE (LKE) #PRO</option><option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ#LEMAH SHIO</option><option value="LSAC">LEMAH SHIO AC (LSAC) #PRO</option><option value="LSCK">LEMAH SHIO CK (LSCK) #PRO</option><option value="LSKE">LEMAH SHIO KE (LSKE) #PRO</option><option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ#GANJIL/GENAP</option><option value="GGA">GG AS (Ganjil/Genap) #PRO</option><option value="GGC">GG COP (Ganjil/Genap) #PRO</option><option value="GGK">GG KEPALA (Ganjil/Genap) #PRO</option><option value="GGE">GG EKOR (Ganjil/Genap) #PRO</option><option value="GGJ">GG JUMLAH (Ganjil/Genap) #PRO</option><option value="" disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ#BESAR/KECIL</option><option value="BKA">BK AS (Besar/Kecil) #PRO</option><option value="BKC">BK COP (Besar/Kecil) #PRO</option><option value="BKK">BK KEPALA (Besar/Kecil) #PRO</option><option value="BKE">BK EKOR (Besar/Kecil) #PRO</option><option value="BKJ">BK JUMLAH (Besar/Kecil) #PRO</option></select></div><div class="control-group"><label>‚ùå Patah Prediksi</label><input type="text" id="patahLimit" value="" pattern="[0-5]*" maxlength="1" placeholder="Kosongkan = tidak ada patah" title="0-5 patah"></div><div class="control-group"><label>üîÄ Urutan Pengujian</label><select id="searchMode"><option value="urutan" selected>Urutan (berurutan)</option><option value="suffle">Suffle (acak lengkap) #PRO</option></select></div><div class="control-group"><label>üé≤ Batch Pengujian</label><select id="batchSize"><option value="1000" selected>1.000 (Versi Terbatas)</option><option value="100000">100.000 #PRO</option><option value="500000">500.000 #PRO</option><option value="1000000">1.000.000 #PRO</option><option value="2000000">2.000.000 #PRO</option><option value="5000000">5.000.000 #PRO</option></select></div><div class="control-group"><label>üõó 3 Kombinasi</label><div class="control-input checkbox-input"><input type="checkbox" id="enableTriple"><span>Khusus 3 Komponen</span></div></div><div class="control-group"><label>‚õî Stop Menemukan</label><input type="text" id="stopAfterCount" value="4" placeholder="Kosongkan = cek semua" inputmode="numeric" pattern="[0-9]*" maxlength="6"></div></div><div class="digit-selection full-width"><h3 class="mistik-title">PILIH MISTIK YANG DIGUNAKAN</h3><small style="font-size:10px; opacity:0.8; display: block; margin: 10px auto; text-align: center;">semakin banyak yang dipilih,semakin lama proses pengujian!</small><div class="mistik-grid" id="MistikCheckboxes"><label class="mistik-item"><input type="checkbox" id="ix" value="ix" data-mistik="ix" name="mistikExtra[]" checked><span>ix</span></label><label class="mistik-item"><input type="checkbox" id="ml" value="ml" data-mistik="ml" name="mistikExtra[]" checked><span>ml</span></label><label class="mistik-item"><input type="checkbox" id="mb" value="mb" data-mistik="mb" name="mistikExtra[]" checked><span>mb</span></label><label class="mistik-item"><input type="checkbox" id="ty" value="ty" data-mistik="ty" name="mistikExtra[]" checked><span>ty</span></label><label class="mistik-item"><input type="checkbox" id="m9" value="m9" data-mistik="m9" name="mistikExtra[]" checked><span>m9</span></label><label class="mistik-item"><input type="checkbox" id="m0" value="m0" data-mistik="m0" name="mistikExtra[]"><span>m0</span></label><label class="mistik-item"><input type="checkbox" id="m1" value="m1" data-mistik="m1" name="mistikExtra[]"><span>m1</span></label><label class="mistik-item"><input type="checkbox" id="m2" value="m2" data-mistik="m2" name="mistikExtra[]"><span>m2</span></label><label class="mistik-item"><input type="checkbox" id="m3" value="m3" data-mistik="m3" name="mistikExtra[]"><span>m3</span></label><label class="mistik-item"><input type="checkbox" id="m4" value="m4" data-mistik="m4" name="mistikExtra[]"><span>m4</span></label><label class="mistik-item"><input type="checkbox" id="m5" value="m5" data-mistik="m5" name="mistikExtra[]"><span>m5</span></label><label class="mistik-item"><input type="checkbox" id="m6" value="m6" data-mistik="m6" name="mistikExtra[]"><span>m6</span></label><label class="mistik-item"><input type="checkbox" id="m7" value="m7" data-mistik="m7" name="mistikExtra[]"><span>m7</span></label><label class="mistik-item"><input type="checkbox" id="m8" value="m8" data-mistik="m8" name="mistikExtra[]"><span>m8</span></label><label class="mistik-item"><input type="checkbox" id="m10" value="m10" data-mistik="m10" name="mistikExtra[]"><span>m10</span></label></div></div><div class="control-group full-width"><div class="control-input checkbox-input"><input type="checkbox" id="autoContinue"><span>Auto-continue semua sesi (pause 5 detik antar sesi)</span></div></div><div class="button-group"><button class="action-button btn-search" onclick="onStartSearchClick()" id="searchBtn"><span>üöÄ</span><span>CARI RUMUS</span></button><button class="action-button btn-stop" onclick="stopSearch()" id="stopBtn" disabled><span>‚èπÔ∏è</span><span>STOP</span></button><button class="action-button btn-continue" onclick="onContinueSearchClick()" id="continueBtn" disabled><span>‚ñ∂Ô∏è</span><span>LANJUT</span></button><button class="action-button btn-clear" onclick="clearAllData()"><span>üóëÔ∏è</span><span>HAPUS DATA</span></button><button class="action-button btn-reset" onclick="resetProgressOnly()"><span>‚ôªÔ∏è</span><span>RESET PROGRES</span></button></div><div class="status-info" id="statusInfo"></div></div><div class="output-section"><div class="section-title">‚ö° LIVE TEMUAN (Real-time)</div><div class="result-table-container" id="liveFindingsWrap"><table class="live-table"><thead><tr><th>Rumus</th><th>PolaN</th><th>Prediksi</th></tr></thead><tbody id="liveFindingsBody"></tbody></table></div><div class="section-title hasil-lengkap-title">üìÑ HASIL LENGKAP</div><div class="result-display" id="resultOutput"><!-- UNTUK FITUR LENGKAP + KODE TERSUSUN RAPI HANYA TERSEDIA DI VERSI PRO --></div><div class="section-title hidden" id="formulaTableLabel">üßæ DAFTAR RUMUS (PILIH UNTUK DISALIN)</div><div class="result-table-container hidden" id="formulaTableWrap"><table id="resultTable"><thead><tr><th>No</th><th>Rumus</th><th>Pola</th><th>Patah</th><th>Prediksi</th><th><input type="checkbox" id="selectAllRows"></th></tr></thead><tbody id="resultTableBody"></tbody></table></div><div class="output-buttons"><button class="action-button btn-summary" onclick="onRangkumClick()"><span>üß©</span><span>RANGKUM RUMUS</span></button><button class="action-button btn-copy-normal" onclick="copyOutput()"><span>üìã</span><span>SALIN NORMAL</span></button><button class="action-button btn-copy-multi" onclick="copyOutputMulti()"><span>üìë</span><span>SALIN MULTI</span></button><button class="action-button btn-clear-output" onclick="clearOutput()"><span>üóëÔ∏è</span><span>HAPUS OUTPUT</span></button><button class="action-button btn-copy-selected" onclick="copySelectedRows()"><span>üìã</span><span>SALIN TABEL</span></button></div></div></div><div class="footer"><div class="version">Prediksi Tools - Rumus Otomatis</div><div>¬© RAN</div></div></div><!-- UNTUK FITUR LENGKAP + KODE TERSUSUN RAPI HANYA TERSEDIA DI VERSI PRO --><script>function lockViewportHeight(){const vh = window.innerHeight * 0.01;document.documentElement.style.setProperty('--vh',`${vh}.result-display.output-mode-locked,.result-display.output-mode-empty{white-space: normal !important;font-family: inherit !important;height: auto !important;min-height: 560px;overflow: visible !important;}px`);}function unlockViewportHeight(){document.documentElement.style.removeProperty('--vh');}function showNotification(message,type = 'success',duration = 5000){const el = document.getElementById('notification');if (!el) return;el.className = 'notification '+type;el.textContent = message;el.classList.add('show');clearTimeout(el._hideTimer);el._hideTimer = setTimeout(hideNotification,duration);}function hideNotification(){const el = document.getElementById('notification');if (!el) return;el.classList.remove('show');el.classList.add('hide');setTimeout(() =>{el.className = 'notification';},300);}const RumusOtomatis ={mistikTables:{IX:{'0':'5','1':'6','2':'7','3':'8','4':'9','5':'0','6':'1','7':'2','8':'3','9':'4'},TY:{'0':'7','1':'4','2':'9','3':'6','4':'1','5':'8','6':'3','7':'0','8':'5','9':'2'},ML:{'0':'1','1':'0','2':'5','3':'8','4':'7','5':'2','6':'9','7':'4','8':'3','9':'6'},MB:{'0':'8','1':'7','2':'6','3':'9','4':'5','5':'4','6':'2','7':'1','8':'0','9':'3'},M9:{'0':'9','1':'0','2':'1','3':'2','4':'3','5':'4','6':'5','7':'6','8':'7','9':'8'}},DEFAULT_MISTIK_SET: ['IX','ML','MB','TY','M9'],BATCH_SIZE: 1000,dataHistory: [],aiFormulas: [],aiFormulaIterator: null,currentFormula: null,allPatterns: [],foundResults: [],uniqueAIFormulas: new Set(),isSearching: false,stopRequested: false,visibilityPaused: false,paused: false,recoveryAttempted: false,estimationSystem:{phases:{instant: null,quick: null,sampled: null,adaptive: null,final: null},counters:{generated: 0,processed: 0,valid: 0,lastUpdate: 0},learning:{validityRatios: [],processingRates: [],accuracy: 0.3,cache: new Map()},config:{sampleSize: 1000,minConfidence: 0.8,maxSamples: 50000},ui:{displayElement: null,isUpdating: false,lastUiUpdate: 0,forceUpdate: false},continuousInterval: null},deferDetailedOutput: false,_finalOutputBuffer: [],_liveFoundCount: 0,startTime: null,currentPatahLimit: 0,totalCombinations: 0,currentSession: 0,totalSessions: 0,processedInSession: 0,totalProcessed: 0,currentFormulaIndex: 0,currentPatternIndex: 0,lastSaveTime: 0,continueTimeout: null,batchInterval: null,animationFrameId: null,batchTimerId: null,_inputSaveTimeout: null,_notificationTimeout: null,PERSISTENCE_CONFIG:{VERSION: '3.0',AUTO_SAVE_INTERVAL: 10000,INPUT_DEBOUNCE: 500,MAX_SAVE_SIZE: 1024 * 1024 * 5,COMPRESS_THRESHOLD: 100},_patternStepsCache: new Map(),_formulaParseCache: new Map(),_targetDigitsCache: null,_debugMode: false,getExtraMistikFromCheckboxes: function(){const selected = [];for (const id of this.EXTRA_MISTIK_IDS){const el = document.getElementById(id);if (el && el.checked){selected.push(id.toUpperCase());}}return selected;},getActiveMistikTables: function(){const selected = [];try{const nodes = document.querySelectorAll('#MistikCheckboxes input[type="checkbox"][name="mistikExtra[]"]');nodes.forEach(n =>{if (n && n.checked){const v = String(n.value || n.getAttribute('data-mistik') || n.id || '').trim().toUpperCase();if (v) selected.push(v);}});}catch (e){}const valid = selected.filter((k,i) => selected.indexOf(k) === i && this.mistikTables[k]);return valid;},getActiveMistikListForGenerator: function(){return this.getActiveMistikTables().map(m => String(m).toLowerCase());},escapeHTML: function(str){return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');},resetLiveFindings: function(){const tbody = document.getElementById('liveFindingsBody');if (tbody) tbody.innerHTML = '';this._liveFoundCount = 0;},pushLiveFinding: function(rumus,pola,prediksi){const tbody = document.getElementById('liveFindingsBody');if (!tbody) return;this._liveFoundCount = (this._liveFoundCount || 0)+1;if (this._liveFoundCount > 300) return;const tr = document.createElement('tr');const td1 = document.createElement('td');td1.textContent = rumus;const td2 = document.createElement('td');td2.textContent = pola;const td3 = document.createElement('td');td3.textContent = prediksi;tr.appendChild(td1);tr.appendChild(td2);tr.appendChild(td3);tbody.appendChild(tr);},flushFinalOutputPartial: function(forceScroll = false){const box = document.getElementById('resultOutput');if (!box) return;if (!this._finalOutputBuffer || this._finalOutputBuffer.length === 0) return;this._flushForceScroll = !!(this._flushForceScroll || forceScroll);if (this._isFlushingFinalOutput) return;this._isFlushingFinalOutput = true;const CHUNK_SIZE = 400; const self = this;function flushChunk(){if (!self._finalOutputBuffer || self._finalOutputBuffer.length === 0){self._isFlushingFinalOutput = false;if (self._flushForceScroll){box.scrollTop = box.scrollHeight;}self._flushForceScroll = false;return;}const part = self._finalOutputBuffer.splice(0,CHUNK_SIZE).join('');box.insertAdjacentHTML('beforeend',part);requestAnimationFrame(flushChunk);}requestAnimationFrame(flushChunk);},flushFinalOutput: function(){const box=document.getElementById('resultOutput');const __near=box&&((box.scrollHeight-box.scrollTop-box.clientHeight)<40);this.flushFinalOutputPartial(!!__near);},setResultPlain: function(text){const box = document.getElementById('resultOutput');if (this.deferDetailedOutput){this._finalOutputBuffer = [];box.innerHTML = '';box.scrollTop = 0;return;}const __nearBottom=(box.scrollHeight-box.scrollTop-box.clientHeight)<40;box.innerHTML = this.escapeHTML(text);if(__nearBottom) box.scrollTop = box.scrollHeight;},appendResultPlain: function(text){if (this.deferDetailedOutput){if (!this._finalOutputBuffer) this._finalOutputBuffer = [];this._finalOutputBuffer.push(this.escapeHTML(text));return;}const box = document.getElementById('resultOutput');const __nearBottom=(box.scrollHeight-box.scrollTop-box.clientHeight)<40;box.innerHTML += this.escapeHTML(text);if(__nearBottom) box.scrollTop = box.scrollHeight;},appendResultHTML: function(html){if (this.deferDetailedOutput){if (!this._finalOutputBuffer) this._finalOutputBuffer = [];this._finalOutputBuffer.push(html);return;}const box = document.getElementById('resultOutput');const __nearBottom=(box.scrollHeight-box.scrollTop-box.clientHeight)<40;box.innerHTML += html;if(__nearBottom) box.scrollTop = box.scrollHeight;},init: function(){;const ta = document.getElementById('inputNumbers');if (ta){const savedInput = localStorage.getItem('prediksi_input');if (savedInput && savedInput.trim()){ta.value = savedInput;console.log('',savedInput.split('\n').length,'baris');}else{;}}this.setupTheme();this.setupEventListeners();this.updateDataCount();this.loadProgress();this.updateStatusInfo();;},setupTheme: function(){const themeButton = document.getElementById('themeButton');const themeIcon = document.getElementById('themeIcon');const themeText = document.getElementById('themeText');function getPreferredTheme(){const savedTheme = localStorage.getItem('theme');if (savedTheme) return savedTheme;if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){return 'dark';}return 'light';}function setTheme(theme){if (theme === 'dark'){document.body.classList.add('dark-theme');themeIcon.textContent = '‚òÄÔ∏è';themeText.textContent = 'Mode Terang';themeButton.title = 'Ubah ke mode terang';themeButton.setAttribute('aria-label','Ubah ke mode terang');}else{document.body.classList.remove('dark-theme');themeIcon.textContent = 'üåô';themeText.textContent = 'Mode Gelap';themeButton.title = 'Ubah ke mode gelap';themeButton.setAttribute('aria-label','Ubah ke mode gelap');}localStorage.setItem('theme',theme);}function toggleTheme(){const isDark = document.body.classList.contains('dark-theme');setTheme(isDark ? 'light':'dark');}setTheme(getPreferredTheme());themeButton.addEventListener('click',toggleTheme);if (window.matchMedia){window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change',e =>{if (!localStorage.getItem('theme')){setTheme(e.matches ? 'dark':'light');}});}},setupEventListeners: function(){const daysInput = document.getElementById('daysToPredict');if (daysInput){daysInput.addEventListener('input',() =>{this.validateNumberInput(daysInput,1,200);this.saveSettings();});}const digitInput = document.getElementById('digitCount');if (digitInput){digitInput.addEventListener('input',() =>{const tt = document.getElementById('targetType')?.value || 'KE';;this.saveSettings();});}const patahInput = document.getElementById('patahLimit');if (patahInput){patahInput.addEventListener('input',() =>{const value = patahInput.value.replace(/[^\d]/g,'');if (value === ''){patahInput.value = '';}else{let numValue = parseInt(value,10);if (numValue > 5) numValue = 5;patahInput.value = String(numValue);}this.updateStatusInfo();this.saveSettings();});}const numbersTextarea = document.getElementById('inputNumbers');if (numbersTextarea){numbersTextarea.addEventListener('input',() =>{this.updateDataCount();clearTimeout(this._inputSaveTimeout);this._inputSaveTimeout = setTimeout(() =>{this.autoSaveInput();;},1000);});numbersTextarea.addEventListener('blur',() =>{this.validateTextareaInput(numbersTextarea);this.autoSaveInput();;});numbersTextarea.addEventListener('paste',() =>{setTimeout(() =>{this.validateTextareaInput(numbersTextarea);this.autoSaveInput();;},100);});}const inputsToWatch = ['daysToPredict','digitCount','patahLimit','targetType'];inputsToWatch.forEach(id =>{const element = document.getElementById(id);if (element){element.addEventListener('change',() =>{this.updateStatusInfo();this.saveSettings();});}});const toggleBtn = document.getElementById('toggleShioTable');const tableBox = document.getElementById('shioTableContainer');if (toggleBtn && tableBox){toggleBtn.addEventListener('click',() =>{const isOpen = tableBox.style.display === 'block';tableBox.style.display = isOpen ? 'none':'block';toggleBtn.textContent = isOpen ? 'Tampilkan':'Sembunyikan';});}const targetSel = document.getElementById('targetType');const digitInput2 = document.getElementById('digitCount');function syncDigitLimitForTarget(){if (!digitInput2) return;const tt = targetSel?.value || 'KE';;}if (targetSel){targetSel.addEventListener('change',() =>{syncDigitLimitForTarget();});syncDigitLimitForTarget();}if (Array.isArray(this.EXTRA_MISTIK_IDS)){this.EXTRA_MISTIK_IDS.forEach(id =>{const el = document.getElementById(id);if (el){el.addEventListener('change',() =>{this.updateStatusInfo();this.saveSettings();});}});}const batchSizeEl = document.getElementById('batchSize');;},validateNumberInput: function(input,min,max){const value = input.value.replace(/[^\d]/g,'');if (value === ''){input.value = '';return false;}let numValue = parseInt(value,10);if (isNaN(numValue)){numValue = min;}if (numValue < min) numValue = min;if (numValue > max) numValue = max;input.value = String(numValue);this.updateStatusInfo();return true;},validateTextareaInput: function(textarea){const original = textarea.value;const cursorPosition = textarea.selectionStart;const lines = original.split('\n');let cleanedLines = [];for (let line of lines){const trimmedLine = line.trim();if (!trimmedLine){cleanedLines.push('');continue;}const hasSpecialSeparator = /[¬ª=‚Üí\.\.\-\->=>:\+\~,]/.test(trimmedLine);if (hasSpecialSeparator){const parts = trimmedLine.split(/[¬ª=‚Üí\.\.\-\->=>:\+\~,]/);const firstPart = parts[0].trim();const digits = firstPart.match(/\d/g) || [];if (digits.length >= 4){cleanedLines.push(digits.slice(0,4).join(''));}}else if (/\t|\s{2,}/.test(trimmedLine)){const parts = trimmedLine.split(/\t|\s{2,}/);for (let part of parts){const trimmedPart = part.trim();if (trimmedPart && /^\d/.test(trimmedPart)){const digits = trimmedPart.match(/\d/g) || [];if (digits.length >= 4){cleanedLines.push(digits.slice(0,4).join(''));}}}}else{const firstNumberMatch = trimmedLine.match(/(\d{4,})/);if (firstNumberMatch){cleanedLines.push(firstNumberMatch[1].substring(0,4));}}}let result = '';let lastLine = '';for (let line of cleanedLines){if (line !== lastLine || line === ''){if (result) result += '\n';result += line;lastLine = line;}}while (result.endsWith('\n\n')){result = result.slice(0,-1);}if (result !== original){textarea.value = result;try{setTimeout(() =>{const safePos = Math.min(cursorPosition,textarea.value.length);textarea.setSelectionRange(safePos,safePos);},0);}catch (e){}}this.updateDataCount();},updateDataCount: function(){const input = document.getElementById('inputNumbers').value.trim();const lines = input.split('\n').map(l => l.trim()).filter(l => /^\d{4}$/.test(l));const count = lines.length;document.getElementById('dataCount').textContent = String(count);this.updateStatusInfo();return count;},reduceToSingleDigit: function(num){let n = Math.abs(num);while (n > 9){n = n.toString().split('').reduce((sum,d) => sum+parseInt(d,10),0);}return n;},convertMistik: function(number,table){const digit = this.reduceToSingleDigit(parseInt(number,10)).toString();const key = String(table || '').toUpperCase();return (this.mistikTables[key] && this.mistikTables[key][digit]) ? this.mistikTables[key][digit] : digit;},getTargetTypeName: function(type){const names={K:'KEPALA',E:'EKOR',KE:'KE (2D BELAKANG)'}; return names[type]||type;},getSuffixForTargetType: function(targetType){const m={K:'k',E:'e',KE:'ke'}; return m[targetType]||'pro';},isLemahTargetType: function(targetType){return typeof targetType === 'string' && targetType.startsWith('L');},getBaseTargetType: function(targetType){if (!this.isLemahTargetType(targetType)) return targetType;return targetType.substring(1);},bkLabelFromDigit: function(d){const n = parseInt(d,10);if (isNaN(n)) return '';return (n >= 5) ? 'besar':'kecil';},bkSizeBitFromDigit: function(d){const n = parseInt(d,10);if (isNaN(n)) return null;return (n >= 5) ? 1 : 0;},getColorClassByPosition: function(position){const m={K:'color-kepala',E:'color-ekor'}; return m[position]||'color-default';},getDominantColorForTarget: function(targetType){const m={K:'color-kepala',E:'color-ekor',KE:'color-kepala'}; return m[targetType]||'color-default';},formatPredictionWithColors: function(prediction,checkResult,isLatestPrediction = false){if (!prediction) return '';const predStr = prediction.toString();const isTokenized = predStr.includes(' ');const items = isTokenized ? predStr.trim().split(/\s+/) : predStr.split('');const sep = isTokenized ? ' ':'';let formatted = '';if (isLatestPrediction && (!checkResult || checkResult.matchedDetails.length === 0)){const dominantColor = this.getDominantColorForTarget(checkResult?.targetType || 'K');for (let i = 0; i < items.length; i++){formatted += `<span class="${dominantColor}">${items[i]}</span>`;if (sep && i < items.length - 1) formatted += sep;}return formatted;}const matchedIndexes = checkResult?.matchedDetails?.map(d => d.indexInPrediction) || [];for (let i = 0; i < items.length; i++){const digit = items[i];if (matchedIndexes.includes(i)){const detail = checkResult.matchedDetails.find(d => d.indexInPrediction === i);formatted += `<span class="${detail?.colorClass || 'color-default'}">${digit}</span>`;}else{formatted += digit;}if (sep && i < items.length - 1) formatted += sep;}return formatted;},processComponent: function(component,currentDayIndex,data){if (!this._componentValueCache) this._componentValueCache = new Map();const __ck = component+'|'+currentDayIndex;const __cv = this._componentValueCache.get(__ck);if (__cv !== undefined) return __cv;const match = component.match(/^(J4D|J3D|Js|A|C|K|E|J)(\d{1,2})([A-Za-z0-9]*)$/);if (!match){throw new Error(`Komponen tidak valid: ${component}`);}const type = match[1];const dayStr = match[2];const mistik = match[3];const dayOffset = parseInt(dayStr,10);const targetDayIndex = currentDayIndex - (dayOffset - 1);if (targetDayIndex < 0){throw new Error(`Data tidak cukup untuk ${component}`);}const d = data[targetDayIndex];let val;switch (type){case 'A':val = parseInt(d[0],10);break;case 'C':val = parseInt(d[1],10);break;case 'K':val = parseInt(d[2],10);break;case 'E':val = parseInt(d[3],10);break;case 'J':{const k = parseInt(d[2],10);const e = parseInt(d[3],10);val = this.reduceToSingleDigit(k+e);break;}case 'Js':{const k = parseInt(d[2],10);const e = parseInt(d[3],10);val = this.reduceToSingleDigit(Math.abs(k - e));break;}case 'J3D':{const c = parseInt(d[1],10);const k = parseInt(d[2],10);const e = parseInt(d[3],10);val = this.reduceToSingleDigit(c+k+e);break;}case 'J4D':{const a = parseInt(d[0],10);const c = parseInt(d[1],10);const k = parseInt(d[2],10);const e = parseInt(d[3],10);val = this.reduceToSingleDigit(a+c+k+e);break;}default:throw new Error(``);}if (mistik){const m = String(mistik).toUpperCase();if (this.mistikTables && this.mistikTables[m]){val = parseInt(this.convertMistik(val,m),10);}}this._componentValueCache.set(__ck,val);return val;},_getCompiledFormula: function(formula){let formulaKey = String(formula || '').trim();formulaKey = formulaKey.replace(/\.\(\s*ix\s*\)\s*$/i,'').trim();if (!this._compiledFormulaCache) this._compiledFormulaCache = new Map();const cached = this._compiledFormulaCache.get(formulaKey);if (cached) return cached;let working = formulaKey;let finalMistik = null;const finalMatch = working.match(/\.\(\s*([^)]+?)\s*\)$/);if (finalMatch){const fm = String(finalMatch[1] || '').trim().toLowerCase();if (fm !== 'ix'){finalMistik = String(finalMatch[1] || '').trim().toUpperCase();}working = working.replace(/\.\(\s*([^)]+?)\s*\)$/,'').trim();}const parts = working.match(/([A-Za-z]+\d+[A-Za-z0-9]*|[+\-])/g) || [];if (parts.length === 0){const outBad ={formulaKey,tokens: [],signs: [],finalMistik,isZero: false,hasSelfReducing: false};this._compiledFormulaCache.set(formulaKey,outBad);return outBad;}const tokens = [];const signs = [];let currentOp = '+';for (const part of parts){if (part === '+'|| part === '-'){currentOp = part;continue;}const tok = part.trim();if (!tok) continue;tokens.push(tok);signs.push(currentOp === '-' ? -1 : +1);}const coef = new Map();const signInfo = new Map(); for (let i = 0; i < tokens.length; i++){const t = tokens[i];const s = signs[i];coef.set(t,(coef.get(t) || 0)+s);const si = signInfo.get(t) ||{cnt: 0,hasMinus: false};si.cnt++;if (s < 0) si.hasMinus = true;signInfo.set(t,si);}let isZero = true;for (const v of coef.values()){if (v !== 0){isZero = false; break;}}if (tokens.length === 0) isZero = false;let hasSelfReducing = false;for (const si of signInfo.values()){if (si.cnt > 1 && si.hasMinus){hasSelfReducing = true; break;}}const out ={formulaKey,tokens,signs,finalMistik,isZero,hasSelfReducing};this._compiledFormulaCache.set(formulaKey,out);return out;},calculateAI: function(formula,idx,data){let formulaKey = String(formula || '').trim();formulaKey = formulaKey.replace(/\.\(\s*ix\s*\)\s*$/i,'').trim();if (!this._aiValueCache) this._aiValueCache = new Map();const aiCacheKey = formulaKey+'|'+idx;const aiCachedValue = this._aiValueCache.get(aiCacheKey);if (aiCachedValue !== undefined) return aiCachedValue;const compiled = this._getCompiledFormula(formulaKey);if (this.X2_ENABLE_PAIR_CACHE && compiled && compiled.tokens && compiled.tokens.length === 3 && !compiled.finalMistik){if (!this._aiPairCache) this._aiPairCache = new Map();}let total = 0;if (this.X2_ENABLE_PAIR_CACHE && compiled && compiled.tokens && compiled.tokens.length === 3 && !compiled.finalMistik){const t0 = compiled.tokens[0],t1 = compiled.tokens[1],t2 = compiled.tokens[2];const s0 = compiled.signs[0],s1 = compiled.signs[1],s2 = compiled.signs[2];const k = t0+'|'+s0+'|'+t1+'|'+s1+'|'+idx;let partial = this._aiPairCache.get(k);if (partial === undefined){const v0 = this.processComponent(t0,idx,data);const v1 = this.processComponent(t1,idx,data);partial = (s0 * v0)+(s1 * v1);if (this._aiPairCache.size > 500000) this._aiPairCache.clear();this._aiPairCache.set(k,partial);}const v2 = this.processComponent(t2,idx,data);total = partial+(s2 * v2);}else{for (let i = 0; i < compiled.tokens.length; i++){const tok = compiled.tokens[i];const sgn = compiled.signs[i];const val = this.processComponent(tok,idx,data);total += (sgn * val);}}if (compiled.finalMistik){if (this.mistikTables && this.mistikTables[compiled.finalMistik]){total = parseInt(this.convertMistik(total,compiled.finalMistik),10);}}const out = this.reduceToSingleDigit(total);this._aiValueCache.set(aiCacheKey,out);return out;},generateRotation: function(ai){const a = this.reduceToSingleDigit(ai); if (!this._rotationCache10) this._rotationCache10 = new Array(10);if (this._rotationCache10[a]) return this._rotationCache10[a];const rotation = new Array(10);for (let i = 0; i < 10; i++) rotation[i] = (a+i) % 10;this._rotationCache10[a] = rotation;return rotation;},applyPatternToRotation: function(rotation,pattern){let stepsArr = this._patternStepsCache.get(pattern);if (!stepsArr){const steps = pattern.match(/N(\d)/g);if (!steps || steps.length === 0) return '';stepsArr = steps.map(s => parseInt(s.substring(1),10));this._patternStepsCache.set(pattern,stepsArr);}let currentPosition = stepsArr[0] % 10;let result = rotation[currentPosition].toString();for (let i = 1; i < stepsArr.length; i++){currentPosition = (currentPosition+stepsArr[i]) % 10;result += rotation[currentPosition].toString();}return result;},getTargetDigits: function(nextData,targetType){targetType = this.getBaseTargetType(targetType);switch (targetType){case 'K':return nextData[2].toString();case 'E':return nextData[3].toString();case 'KE':return nextData[2].toString()+nextData[3].toString();return nextData;default:return nextData;}},checkPrediction: function(predictionDigits,targetDigits,targetType,nextNumber = ''){targetType = this.getBaseTargetType(targetType);const result ={hit: false,matchedDigits: [],matchedPositions: [],matchedDetails: []};if (['A','C','K','E','J'].includes(targetType)){for (let i = 0; i < predictionDigits.length; i++){const predDigit = predictionDigits[i];if (predDigit === targetDigits){result.hit = true;let matchedPosition = targetType;if (nextNumber && nextNumber.length === 4){if (targetType === 'K' && predDigit === nextNumber[2]){matchedPosition = 'K';}else if (targetType === 'E' && predDigit === nextNumber[3]){matchedPosition = 'E';}}result.matchedDigits.push(predDigit);result.matchedPositions.push(matchedPosition);result.matchedDetails.push({digit: predDigit,position: matchedPosition,colorClass: this.getColorClassByPosition(matchedPosition),indexInPrediction: i});}}}else if (['AC','CK','KE','CB'].includes(targetType)){for (let i = 0; i < predictionDigits.length; i++){const predDigit = predictionDigits[i];for (let j = 0; j < targetDigits.length; j++){if (predDigit === targetDigits[j]){result.hit = true;let matchedPosition = '';if (targetType === 'KE'){matchedPosition = (j === 0) ? 'K':'E';}result.matchedDigits.push(predDigit);result.matchedPositions.push(matchedPosition);result.matchedDetails.push({digit: predDigit,position: matchedPosition,colorClass: this.getColorClassByPosition(matchedPosition),indexInPrediction: i});break;}}}}return result;},testSingleTargetType: function(aiFormula,pattern,data,daysToTest,patahLimit,targetType){if (data.length < daysToTest+1) return null;let hits = 0;let attempts = 0;let patah = 0;const predictions = [];const startTestIndex = data.length - daysToTest;for (let i = daysToTest - 1; i >= 0; i--){const inputIndex = startTestIndex+i - 1;const targetIndex = startTestIndex+i;if (inputIndex < 0 || targetIndex >= data.length) break;try{const ai = this.calculateAI(aiFormula,inputIndex,data);let pred;const baseTT = this.getBaseTargetType(targetType);if (''.split(',').includes(baseTT)){;;}else if (''.split(',').includes(baseTT)){;;}else if ([''].includes(targetType)){;;}else{const rotation = this.generateRotation(ai);pred = this.applyPatternToRotation(rotation,pattern);}const targetData = data[targetIndex];const targetDigits = (this._targetDigitsCache && this._targetDigitsCache[targetIndex] !== undefined)? this._targetDigitsCache[targetIndex]: this.getTargetDigits(targetData,targetType);const check = this.checkPrediction(pred,targetDigits,targetType,targetData);predictions.push({input: data[inputIndex],prediction: pred,target: targetDigits,hit: check.hit,matchedDigits: check.matchedDigits,matchedPositions: check.matchedPositions,matchedDetails: check.matchedDetails,checkResult: check,ai: ai});attempts++;if (check.hit){hits++;}else{patah++;if (patahLimit >= 0 && patah > patahLimit){return null;}if (patah > patahLimit) return null;}}catch (e){return null;}}if (attempts < daysToTest) return null;if (patah > patahLimit) return null;return{fullFormula: `${aiFormula}${pattern}`,aiFormula,pattern,targetType,hits,attempts,patah,accuracy: hits / attempts,predictions,passed: patah <= patahLimit};},testSingleTargetTypeLemah: function(aiFormula,pattern,data,daysToTest,patahLimit,lemahTargetType){if (data.length < daysToTest+1) return null;const baseTargetType = this.getBaseTargetType(lemahTargetType);try{if (this.isLemahTargetType(lemahTargetType)){const cf = this._getCompiledFormula(aiFormula);if (cf && (cf.isZero || cf.hasSelfReducing)){return null;}}}catch (e){}let weakHits = 0; let attempts = 0;let patah = 0;const predictions = [];const startTestIndex = data.length - daysToTest;for (let i = daysToTest - 1; i >= 0; i--){const inputIndex = startTestIndex+i - 1;const targetIndex = startTestIndex+i;if (inputIndex < 0 || targetIndex >= data.length) break;try{const ai = this.calculateAI(aiFormula,inputIndex,data);let pred;if ([''].includes(baseTargetType)){;;}else{const rotation = this.generateRotation(ai);pred = this.applyPatternToRotation(rotation,pattern);}const targetData = data[targetIndex];const targetDigits = (this._targetDigitsCache && this._targetDigitsCache[targetIndex] !== undefined)? this._targetDigitsCache[targetIndex]: this.getTargetDigits(targetData,baseTargetType);const check = this.checkPrediction(pred,targetDigits,baseTargetType,targetData);const isWeak = !check.hit;predictions.push({input: data[inputIndex],prediction: pred,target: targetDigits,hit: isWeak,matchedDigits: check.matchedDigits,matchedPositions: check.matchedPositions,matchedDetails: check.matchedDetails,checkResult: check,ai: ai,lemah: true,baseTargetType: baseTargetType});attempts++;if (isWeak){weakHits++;}else{patah++;if (patahLimit >= 0 && patah > patahLimit){return null;}}if (patah > patahLimit){return null;}}catch (e){return null;}}if (attempts === 0) return null;{const allZero = predictions.every(p =>{let s = String(p.prediction || '').trim();if (!s) return false;s = s.split('_')[0].trim();s = s.replace(/\s+/g,'');return s.length > 0 && /^0+$/.test(s);});if (allZero) return null;}return{fullFormula: `${aiFormula}${pattern}`,aiFormula,pattern,targetType: lemahTargetType,hits: weakHits,attempts,patah,accuracy: weakHits / attempts,predictions,passed: patah <= patahLimit};},testCombination: function(aiFormula,pattern,data,daysToTest,patahLimit,targetType){if (this.isLemahTargetType(targetType)){return this.testSingleTargetTypeLemah(aiFormula,pattern,data,daysToTest,patahLimit,targetType);}return this.testSingleTargetType(aiFormula,pattern,data,daysToTest,patahLimit,targetType);},shortNum: function(n){if (!isFinite(n)) return '‚àû';const abs = Math.abs(n);const fmt = (v,suf) =>{const s = (v).toFixed(1).replace(/\.0$/,'');return `${s}${suf}`;};return Math.round(n).toString();},estimateTripleTotals: function(dataLength,daysToTest){const compsCount = 8; const maxOffset = Math.min(9,Math.max(1,Math.min(dataLength,daysToTest)));const activeMistik = this.getActiveMistikTables();const mistiks = [''].concat(activeMistik.map(m => m.toLowerCase()));const tt = document.getElementById('targetType')?.value || '';const byDigit ={};for (const d of [1,2,3,4]){const patterns = Math.pow(10,d);byDigit[d] = formulas * patterns;}return{maxOffset,T,mistiksLen: mistiks.length,finalsLen: F,formulas,byDigit};},generateLazy12Formulas: function(dataLength,daysToTest){const comps = ['A','C','K','E','J','Js','J3D','J4D'];const maxOffset = Math.min(9,Math.max(1,Math.min(dataLength,daysToTest)));const offsets = Array.from({length: maxOffset},(_,i) => i+1);const activeMistik = this.getActiveMistikTables();const mistiks = [''].concat(activeMistik.map(m => m.toLowerCase()));const tt = document.getElementById('targetType')?.value || '';const isShioOrLemahShio = [''].includes(tt);const finals = [''].concat(activeMistik.filter(m => isShioOrLemahShio || m.toLowerCase() !== 'ix').map(m => `.(${m.toLowerCase()})`));const self = this;return{[Symbol.iterator]: function* (){const shuffleEnabled = (self.searchMode === 'suffle');const _shuffle = (arr) =>{for (let i = arr.length - 1; i > 0; i--){const j = Math.floor(Math.random() * (i+1));const t = arr[i]; arr[i] = arr[j]; arr[j] = t;}return arr;};const compIdx = shuffleEnabled ? _shuffle([...Array(comps.length).keys()]) : [...Array(comps.length).keys()];const offsetVals = shuffleEnabled ? _shuffle(offsets.slice()) : offsets.slice();const mistikIdx = shuffleEnabled ? _shuffle([...Array(mistiks.length).keys()]) : [...Array(mistiks.length).keys()];const finalsOrder = shuffleEnabled ? _shuffle(finals.slice()) : finals.slice();const opsOrder = shuffleEnabled ? _shuffle(['+','-']) : ['+','-'];for (const iC of compIdx){const c = comps[iC];for (const o of offsetVals){for (const iM of mistikIdx){const m = mistiks[iM];for (const f of finalsOrder){yield `${c}${o}${m}${f}`;}}}}const compIdxCanonical = [...Array(comps.length).keys()];const compIdxOuter = shuffleEnabled ? _shuffle(compIdxCanonical.slice()) : compIdxCanonical;for (const i1 of compIdxOuter){const o1Order = shuffleEnabled ? _shuffle(offsets.slice()) : offsets.slice();for (const o1 of o1Order){const m1Order = shuffleEnabled ? _shuffle([...Array(mistiks.length).keys()]) : [...Array(mistiks.length).keys()];for (const mi1 of m1Order){const m1 = mistiks[mi1];const c1 = `${comps[i1]}${o1}${m1}`;for (const op of opsOrder){const i2List = [];for (let i2 = i1; i2 < comps.length; i2++) i2List.push(i2);const i2Order = shuffleEnabled ? _shuffle(i2List) : i2List;for (const i2 of i2Order){const startO2 = (i2 === i1) ? o1 : 1;const o2List = [];for (let o2 = startO2; o2 <= maxOffset; o2++) o2List.push(o2);const o2Order = shuffleEnabled ? _shuffle(o2List) : o2List;for (const o2 of o2Order){const startM2 = (i2 === i1 && o2 === o1) ? (mi1+1) : 0;const m2List = [];for (let mi2 = startM2; mi2 < mistiks.length; mi2++) m2List.push(mi2);const m2Order = shuffleEnabled ? _shuffle(m2List) : m2List;for (const mi2 of m2Order){const m2 = mistiks[mi2];const c2 = `${comps[i2]}${o2}${m2}`;for (const f of finalsOrder){yield `${c1}${op}${c2}${f}`;}}}}}}}}}};},generateSingleOnlyFormulas: function(dataLength,daysToTest,requestedOffset){const comps = ['A','C','K','E','J','Js','J3D','J4D'];let maxOffset = parseInt(requestedOffset,9) || 10;if (maxOffset > (dataLength - 1)){maxOffset = Math.max(1,dataLength - 1);}const offsets = Array.from({length: maxOffset},(_,i) => i+1);const activeMistik = this.getActiveMistikTables();const mistiks = [''].concat(activeMistik.map(m => m.toLowerCase()));const tt = document.getElementById('targetType')?.value || '';const self = this;return{[Symbol.iterator]: function* (){const shuffleEnabled = (self.searchMode === 'suffle');const _shuffle = (arr) =>{for (let i = arr.length - 1; i > 0; i--){const j = Math.floor(Math.random() * (i+1));const t = arr[i]; arr[i] = arr[j]; arr[j] = t;}return arr;};const compOrder = shuffleEnabled ? _shuffle(comps.slice()) : comps.slice();const offsetOrder = shuffleEnabled ? _shuffle(offsets.slice()) : offsets.slice();const mistikOrder = shuffleEnabled ? _shuffle(mistiks.slice()) : mistiks.slice();const finalsOrder = shuffleEnabled ? _shuffle(finals.slice()) : finals.slice();for (const c of compOrder){for (const o of offsetOrder){for (const m of mistikOrder){for (const f of finalsOrder){yield `${c}${o}${m}${f}`;}}}}}};},updateCombinationDisplay: function(){const el = document.getElementById('formulaCount');if (!el) return;if (this.totalCombinationsIsEstimate && isFinite(this.totalCombinations) && this.totalCombinations > 0){const acc = this.estimationSystem?.learning?.accuracy || 0.3;const symbol = (acc < 0.5) ? '‚âà' : (acc < 0.8 ? '~':'‚âà');el.textContent = `${symbol}${this.shortNum(this.totalCombinations)}`;el.title = `Estimasi progresif (akurasi: ${Math.round(acc * 100)}%)`;}else{el.textContent = (this.totalCombinations || 0).toLocaleString();el.title = '';}},generateAIFormulas: function(mode,dataLength,daysToTest,enableTriple){const comps = ['A','C','K','E','J','Js','J3D','J4D'];const maxOffset = Math.min(10,Math.max(1,Math.min(dataLength,daysToTest)));const offsets = Array.from({length: maxOffset},(_,i) => i+1);const activeMistik = this.getActiveMistikTables();const mistiks = [''].concat(activeMistik.map(m => m.toLowerCase()));const tt = document.getElementById('targetType')?.value || '';if (!enableTriple){const enableLazy12 = activeMistik.length > 5;if (!enableLazy12){const formulas = new Set();for (const c of comps){for (const o of offsets){for (const m of mistiks){for (const f of finals){formulas.add(`${c}${o}${m}${f}`);}}}}for (let i1 = 0; i1 < comps.length; i1++){for (const o1 of offsets){for (const m1 of mistiks){const c1 = `${comps[i1]}${o1}${m1}`;for (const op of ['+','-']){for (let i2 = i1; i2 < comps.length; i2++){const startO2 = (i2 === i1) ? o1 : 1;for (let o2 = startO2; o2 <= maxOffset; o2++){const startM2 = (i2 === i1 && o2 === o1) ? mistiks.indexOf(m1)+1 : 0;for (let mi2 = startM2; mi2 < mistiks.length; mi2++){const m2 = mistiks[mi2];const c2 = `${comps[i2]}${o2}${m2}`;for (const f of finals){const tokens = [c1,c2];const signs = ['+',op];let skip = false;for (const t of tokens){let cnt = 0,hasMinus = false;for (let j = 0; j < 2; j++){if (tokens[j] === t){cnt++;if (signs[j] === '-') hasMinus = true;}}if (cnt > 1 && hasMinus){skip = true; break;}}if (!skip) formulas.add(`${c1}${op}${c2}${f}`);}}}}}}}}return Array.from(formulas);}return{[Symbol.iterator]: function* (){for (const c of comps){for (const o of offsets){for (const m of mistiks){for (const f of finals){yield `${c}${o}${m}${f}`;}}}}for (let i1 = 0; i1 < comps.length; i1++){for (const o1 of offsets){for (const m1 of mistiks){const c1 = `${comps[i1]}${o1}${m1}`;for (const op of ['+','-']){for (let i2 = i1; i2 < comps.length; i2++){const startO2 = (i2 === i1) ? o1 : 1;for (let o2 = startO2; o2 <= maxOffset; o2++){const startM2 = (i2 === i1 && o2 === o1) ? mistiks.indexOf(m1)+1 : 0;for (let mi2 = startM2; mi2 < mistiks.length; mi2++){const m2 = mistiks[mi2];const c2 = `${comps[i2]}${o2}${m2}`;for (const f of finals){const tokens = [c1,c2];const signs = ['+',op];let skip = false;for (const t of tokens){let cnt = 0,hasMinus = false;for (let j = 0; j < 2; j++){if (tokens[j] === t){cnt++;if (signs[j] === '-') hasMinus = true;}}if (cnt > 1 && hasMinus){skip = true; break;}}if (!skip) yield `${c1}${op}${c2}${f}`;}}}}}}}}}};}return{[Symbol.iterator]: function* (){;const _shuffle = (arr) =>{for (let i = arr.length - 1; i > 0; i--){;}return arr;};const compIdx = shuffleEnabled ? _shuffle([...Array(comps.length).keys()]) : [...Array(comps.length).keys()];const offsetOrder = shuffleEnabled ? _shuffle(offsets.slice()) : offsets.slice();const mistikIdx = shuffleEnabled ? _shuffle([...Array(mistiks.length).keys()]) : [...Array(mistiks.length).keys()];;const opsOrder = shuffleEnabled ? _shuffle(['+','-']) : ['+','-'];for (const i1 of compIdx){for (const o1 of offsetOrder){for (const mi1 of mistikIdx){const m1 = mistiks[mi1];const c1 = `${comps[i1]}${o1}${m1}`;for (let i2 = i1; i2 < comps.length; i2++){const startO2 = (i2 === i1) ? o1 : 1;for (const o2 of offsetOrder){if (o2 < startO2) continue;const startM2 = (i2 === i1 && o2 === o1) ? mi1+1 : 0;for (const mi2 of mistikIdx){if (mi2 < startM2) continue;const m2 = mistiks[mi2];const c2 = `${comps[i2]}${o2}${m2}`;for (let i3 = i2; i3 < comps.length; i3++){const startO3 = (i3 === i2) ? o2 : 1;for (const o3 of offsetOrder){if (o3 < startO3) continue;const startM3 = (i3 === i2 && o3 === o2) ? mi2+1 : 0;for (const mi3 of mistikIdx){if (mi3 < startM3) continue;const m3 = mistiks[mi3];const c3 = `${comps[i3]}${o3}${m3}`;for (const op1 of opsOrder){for (const op2 of opsOrder){for (const f of finalsOrder){const tokens = [c1,c2,c3];const signs = ['+',op1,op2];let skip = false;for (const t of tokens){let cnt = 0,hasMinus = false;for (let j = 0; j < 3; j++){if (tokens[j] === t){cnt++;if (signs[j] === '-') hasMinus = true;}}if (cnt > 1 && hasMinus){skip = true; break;}}if (!skip) yield `${c1}${op1}${c2}${op2}${c3}${f}`;}}}}}}}}}}}}}};},generatePatterns: function(digitCount){const dc = parseInt(digitCount,10) || 1;const patterns = [];if (dc <= 0) return patterns;if (dc === 1){for (let p = 0; p <= 9; p++) patterns.push('N'+p);return patterns;}if (dc > 10) return patterns;const stepsLen = dc - 1;const steps = new Array(stepsLen);function recSteps(stepIdx,sumSoFar,maxSum){if (stepIdx === stepsLen){patterns.push('N'+currentStart+'N'+steps.join('N'));return;}const remainingAfter = stepsLen - stepIdx - 1;const maxStep = (maxSum - sumSoFar) - remainingAfter; for (let s = 1; s <= maxStep; s++){steps[stepIdx] = s;recSteps(stepIdx+1,sumSoFar+s,maxSum);}}for (var currentStart = 0; currentStart <= (10 - dc); currentStart++){const maxSum = 9 - currentStart; recSteps(0,0,maxSum);}return patterns;},calculateInstantEstimate: function(){try{const compsCount = 8; const daysToPredict = parseInt(document.getElementById('daysToPredict')?.value,10) || 10;const digitCount = parseInt(document.getElementById('digitCount')?.value,10) || 1;const singleOffsetInput = parseInt(document.getElementById('singleOffsetInput')?.value,10) || 100;const dataLen = (this.dataHistory && this.dataHistory.length) ? this.dataHistory.length : 0;;const activeMistik = this.getActiveMistikTables();const mistiksCount = (activeMistik?.length || 0)+1; const targetType = (document.getElementById('targetType')?.value || 'KE').toUpperCase();;let formulas = 0;if (enableSingleOnly){formulas = (T * (T - 1) * (T - 2)) / 6 * 4 * finalsCount;formulas *= 0.45;}else{const oneComp = T * finalsCount;const twoComp = (T * (T - 1)) / 2 * 2 * finalsCount; formulas = oneComp+twoComp;formulas *= 0.7;}const patterns = (this.generatePatterns(digitCount) || []).length || 1;return Math.max(1,Math.round((formulas * patterns) / 1000) * 1000);}catch (e){console.warn('calculateInstantEstimate failed:',e);return 0;}},normalizeAIFormula: function(aiFormula){let base = String(aiFormula || '').trim();let finalSuffix = '';const m = base.match(/\.\(\s*([^)]+?)\s*\)\s*$/);if (m){const mistikFinalRaw = String(m[1] || '').trim();const mistikFinal = mistikFinalRaw.toLowerCase();if (mistikFinal !== 'ix'){finalSuffix = `.(${mistikFinalRaw})`;}base = base.replace(/\.\(\s*([^)]+?)\s*\)\s*$/,'').trim();}if (!base.includes('+') && !base.includes('-')){return base+finalSuffix;}const order = ['A','C','K','E','J','Js','J3D','J4D'];const tokens = base.split(/([+\-])/).map(t => t.trim()).filter(Boolean);const terms = [];let sign = +1;for (const t of tokens){if (t === '+'){sign = +1;continue;}if (t === '-'){sign = -1;continue;}terms.push({sign,comp: t});sign = +1;}terms.sort((a,b) =>{const ta = order.findIndex(x => a.comp.startsWith(x));const tb = order.findIndex(x => b.comp.startsWith(x));if (ta !== tb) return ta - tb;const oa = parseInt(a.comp.match(/\d+/)?.shift() || 0,10);const ob = parseInt(b.comp.match(/\d+/)?.shift() || 0,10);if (oa !== ob) return oa - ob;const ca = a.comp.toLowerCase();const cb = b.comp.toLowerCase();if (ca !== cb) return ca.localeCompare(cb);return b.sign - a.sign;});let result = '';for (let i = 0; i < terms.length; i++){const t = terms[i];if (i === 0){result += (t.sign < 0 ? '-':'')+t.comp;}else{result += (t.sign < 0 ? '-':'+')+t.comp;}}return result+finalSuffix;},resetFormulaState: function(){this.aiFormulas = [];this.aiFormulaIterator = null;this.currentFormula = null;this.lazy12Enabled = false;this.allPatterns = [];this.foundResults = [];this.uniqueAIFormulas.clear();this.currentFormulaIndex = 0;this.currentPatternIndex = 0;this.currentSession = 0;if (this.stopAfterCount !== null){this.showNotification(``,'info');}this.processedInSession = 0;this.totalProcessed = 0;},isValidTripleFormula: function(formula){const base = String(formula || '').replace(/\.\([^)]+\)$/,'').trim();const ops = base.match(/[+\-]/g) || [];if (ops.length !== 2) return false;const comps = base.match(/\b(J4D|J3D|Js|A|C|K|E|J)\d{1,2}[A-Za-z]*\b/g) || [];return comps.length === 3;},syncBatchSize: function(){const batchEl = document.getElementById('batchSize');if (!batchEl) return false;const v = parseInt(batchEl.value,10);if (!isNaN(v) && v > 0 && v !== this.BATCH_SIZE){;if (this.isSearching){;}return true;}return false;},stripFinalIX: function(formula){return String(formula || '').replace(/\.\(\s*ix\s*\)\s*$/i,'').trim();},startSearch: function(){this.paused = false;if (this.isSearching) return;this.visibilityPaused = false;if (this.continueTimeout){clearTimeout(this.continueTimeout);this.continueTimeout = null;}try{const input = document.getElementById('inputNumbers').value.trim();const digitCount = parseInt(document.getElementById('digitCount').value,10) || 1;const daysToPredict = parseInt(document.getElementById('daysToPredict').value,10) || 16;const enableTripleRaw = document.getElementById('enableTriple')?.checked ? true : false;const enableSingleOnly = document.getElementById('enableSingleOnly')?.checked ? true : false;const singleOffsetInput = parseInt(document.getElementById('singleOffset')?.value,10) || 10;const enableTriple = enableSingleOnly ? false : enableTripleRaw;const targetType = document.getElementById('targetType').value;const searchMode = document.getElementById('searchMode')?.value || 'urutan';this.searchMode = searchMode;const stopAfterInput = document.getElementById('stopAfterCount')?.value.trim();let stopAfterCount = null;if (stopAfterInput && /^\d+$/.test(stopAfterInput)){stopAfterCount = parseInt(stopAfterInput,10);if (!Number.isFinite(stopAfterCount) || stopAfterCount < 1) stopAfterCount = null;}this.stopAfterCount = stopAfterCount;{const batchEl = document.getElementById('batchSize');if (batchEl){const v = parseInt(batchEl.value,10);if (!isNaN(v) && v > 0){this.BATCH_SIZE = v;;}}}const patahInput = document.getElementById('patahLimit').value;if (patahInput === ''){this.currentPatahLimit = 0;}else{this.currentPatahLimit = parseInt(patahInput,10);if (isNaN(this.currentPatahLimit) ||this.currentPatahLimit < 0 ||this.currentPatahLimit > 5){this.showNotification('Patah harus 0 sampai 5!','error');return;}}if (!input){this.showNotification('Masukkan data terlebih dahulu!','error');return;}if (isNaN(digitCount) || digitCount < 1 || digitCount > 7){this.showNotification('Digit Prediksi harus 1 sampai 7!','error');return;}if (isNaN(daysToPredict) || daysToPredict < 1 || daysToPredict > 200){this.showNotification('Hari Prediksi harus 1 sampai 200!','error');return;}const lines = input.split('\n').map(l => l.trim()).filter(l => /^\d{4}$/.test(l));this.dataHistory = lines;const baseTargetType = this.getBaseTargetType(targetType);this._targetDigitsCache = this.dataHistory.map(d => this.getTargetDigits(d,baseTargetType));if (lines.length < daysToPredict+1){this.showNotification(`Data tidak cukup!\n\nData: ${lines.length}angka\nButuh minimal: ${daysToPredict+1}angka`,'error');return;}const activeMistikForMode = this.getActiveMistikTables();const enableLazy12 = true;this.lazy12Enabled = true;const useLazyIterator = true;if (useLazyIterator){if (enableSingleOnly){;;}else{this.aiFormulaIterator = this.generateLazy12Formulas(lines.length,daysToPredict)[Symbol.iterator]();}this.currentFormula = null;this.aiFormulas = [];this._lazyShuffleBuffer = [];if (this._lazyShuffleEnabled){}}else{this.aiFormulas = this.generateAIFormulas('full',lines.length,daysToPredict,false);const map = new Map();for (const f of this.aiFormulas){const noFinalIx = this.stripFinalIX(f);const key = this.normalizeAIFormula(noFinalIx);if (!map.has(key)) map.set(key,f);}this.aiFormulas = Array.from(map.values());if (this.searchMode === ''){const shuffled = this.aiFormulas.slice();for (let i = shuffled.length - 1; i > 0; i--){const j = Math.floor(Math.random() * (i+1));const tmp = shuffled[i];shuffled[i] = shuffled[j];shuffled[j] = tmp;}this.aiFormulas = shuffled;}if (this.X4_PRUNE_ZERO_AND_SELF_REDUCING){const pruned = [];for (const f of this.aiFormulas){const noFinalIx = this.stripFinalIX(f);const key = this.normalizeAIFormula(noFinalIx);const compiled = this._getCompiledFormula(key);if (compiled && (compiled.isZero || compiled.hasSelfReducing)) continue;pruned.push(f);}this.aiFormulas = pruned;}}this.allPatterns = this.generatePatterns(digitCount);this.totalCombinationsIsEstimate = (useLazyIterator && !enableSingleOnly);this.totalCombinationsEstimateByDigit = null;if (useLazyIterator){if (enableTriple){const est = this.estimateTripleTotals(lines.length,daysToPredict);this.totalCombinations = (est.formulas || 0) * this.allPatterns.length;}else{const compsCount = 8;const mistiksLen = 1+activeMistikForMode.length;const ttLocal = document.getElementById('targetType')?.value || '';const isShioOrLemahShioLocal = [''].includes(ttLocal);const finalsLen = 1+activeMistikForMode.filter(m => isShioOrLemahShioLocal || m.toLowerCase() !== 'ix').length;const maxOffset = enableSingleOnly? Math.max(1,Math.min(1,singleOffsetInput,lines.length - 1)): Math.min(9,Math.max(1,Math.min(lines.length,daysToPredict)));const T = compsCount * maxOffset * mistiksLen;const one = T * finalsLen;;}{const compsCount = 8;const mistiksCount = 1+activeMistikForMode.length;const ttLocal = (document.getElementById('targetType')?.value || 'KE').toUpperCase();const isShioOrLemahShioLocal = [''].includes(ttLocal);const finalsCount = 1+activeMistikForMode.filter(m => isShioOrLemahShioLocal || String(m).toLowerCase() !== 'ix').length;const maxOffset = enableSingleOnly? Math.max(1,Math.min(1,singleOffsetInput,lines.length - 1)): Math.min(9,Math.max(1,Math.min(lines.length,daysToPredict)));const T = compsCount * maxOffset * mistiksCount;let formulas = 0;if (enableSingleOnly){formulas = T * finalsCount;}else if (enableTriple){formulas = (T >= 3) ? (T * (T - 1) * (T - 2)) / 6 * 4 * finalsCount : 0;}else{formulas = (T * T) * finalsCount;}this.totalCombinations = Math.max(0,Math.round(formulas * this.allPatterns.length));this.totalCombinationsIsEstimate = false;this.estimationSystem = null;}}else{this.totalCombinations = this.aiFormulas.length * this.allPatterns.length;}this.totalSessions = useLazyIterator ? undefined : Math.ceil(this.totalCombinations / this.COMBINATIONS_PER_SESSION);if (this._patternStepsCache) this._patternStepsCache.clear();if (this._formulaParseCache) this._formulaParseCache.clear();if (this._aiValueCache) this._aiValueCache.clear();if (this._componentValueCache) this._componentValueCache.clear();if (this._compiledFormulaCache) this._compiledFormulaCache.clear();this.isSearching = true;this._statusSearchingBuilt = false;this.stopRequested = false;this.foundResults = [];this.deferDetailedOutput = true;this._finalOutputBuffer = [];this.resetLiveFindings();const outBox = document.getElementById('resultOutput');if (outBox) outBox.innerHTML = '';this.uniqueAIFormulas.clear();this.currentSession = 0;this.processedInSession = 0;this.totalProcessed = 0;this.currentFormulaIndex = 0;this.currentPatternIndex = 0;this.startTime = new Date();document.getElementById('searchBtn').disabled = true;document.getElementById('stopBtn').disabled = false;document.getElementById('continueBtn').disabled = true;document.getElementById('foundCount').textContent = '0';document.getElementById('processedCount').textContent = '0';this.updateCombinationDisplay();document.getElementById('progressFill').style.width = '0%';document.getElementById('progressPercent').textContent = '0%';let output = '';;this.setResultPlain(output);this.saveProgress();this.flushFinalOutputPartial(false);this.startNewSession();}catch (error){console.error('Error in startSearch:',error);this.showNotification('');this.resetSearchState();}},initializeProgressiveEstimation: function(instantValue){const prevCache = this.estimationSystem?.learning?.cache || new Map();this.estimationSystem ={phases:{instant: instantValue || null,quick: null,sampled: null,adaptive: null,final: null},counters:{generated: 0,processed: 0,valid: 0,lastUpdate: Date.now()},learning:{validityRatios: [],processingRates: [],accuracy: 0.3,cache: prevCache},ui:{displayElement: null,isUpdating: false,lastUiUpdate: 0,forceUpdate: true},continuousInterval: null};this.setupEstimationUI();this.updateEstimationUI();},_runIdle: function(cb,timeoutMs){try{if (typeof requestIdleCallback === 'function'){requestIdleCallback(cb,{timeout: timeoutMs || 800});}else{setTimeout(cb,0);}}catch (e){setTimeout(cb,0);}},startBackgroundEstimationRefinement: function(){setTimeout(() =>{this.beginEstimationRefinementPhase1();},100);},beginEstimationRefinementPhase1: function(){if (!this.isSearching) return;this._runIdle(() =>{this.performQuickSampling();},500);},performQuickSampling: function(){try{if (!this.isSearching || !this.totalCombinationsIsEstimate) return;const sample = this.sampleFormulas(120);if (!sample.total) return;const validRatio = sample.valid / sample.total;this.estimationSystem.learning.validityRatios.push(validRatio);const newEstimate = Math.max(1,Math.round((this.estimationSystem.phases.instant || this.totalCombinations) * validRatio));this.estimationSystem.phases.quick = newEstimate;this.totalCombinations = newEstimate;this.estimationSystem.learning.accuracy = Math.min(0.6,this.estimationSystem.learning.accuracy+0.15);this.updateEstimationUI();setTimeout(() =>{if (this.isSearching) this.beginEstimationRefinementPhase2();},400);}catch (e){console.warn('Quick sampling failed:',e);}},beginEstimationRefinementPhase2: function(){if (!this.isSearching) return;this._runIdle(() =>{this.performThoroughSampling();},1000);},performThoroughSampling: function(){try{if (!this.isSearching || !this.totalCombinationsIsEstimate) return;const sample = this.sampleFormulas(1000);if (!sample.total) return;const validRatio = sample.valid / sample.total;const ratios = [...this.estimationSystem.learning.validityRatios,validRatio];const avgRatio = ratios.reduce((a,b) => a+b,0) / ratios.length;const base = this.estimationSystem.phases.instant || this.totalCombinations;const newEstimate = Math.max(1,Math.round(base * avgRatio));this.estimationSystem.phases.sampled = newEstimate;this.totalCombinations = newEstimate;this.estimationSystem.learning.validityRatios = ratios.slice(-10);this.estimationSystem.learning.accuracy = 0.8;this.updateEstimationUI();this.startContinuousEstimation();}catch (e){console.warn('Thorough sampling failed:',e);}},startContinuousEstimation: function(){if (!this.isSearching) return;if (this.estimationSystem?.continuousInterval) return;this.estimationSystem.continuousInterval = setInterval(() =>{this.updateContinuousEstimation();},2000);},updateContinuousEstimation: function(){if (!this.isSearching){if (this.estimationSystem?.continuousInterval){clearInterval(this.estimationSystem.continuousInterval);this.estimationSystem.continuousInterval = null;}return;}const now = Date.now();const timeElapsed = Math.max(1,now - (this.startTime || now));const processed = this.totalProcessed || 0;const currentRate = processed / (timeElapsed / 1000);const rates = this.estimationSystem.learning.processingRates;rates.push(currentRate);if (rates.length > 5) rates.shift();if (processed > 2000){this.estimationSystem.learning.accuracy = Math.min(0.95,this.estimationSystem.learning.accuracy+0.05);}this.updateEstimationUI();},sampleFormulas: function(sampleSize){const results ={total: 0,valid: 0};sampleSize = Math.min(sampleSize || 0,10000);if (sampleSize <= 0) return results;const daysToPredict = parseInt(document.getElementById('daysToPredict')?.value,10) || 10;const digitCount = parseInt(document.getElementById('digitCount')?.value,10) || 1;const dataLen = (this.dataHistory && this.dataHistory.length) ? this.dataHistory.length : 0;const config ={comps: ['A','C','K','E','J','Js','J3D','J4D'],maxOffset,mistiks: (this.getActiveMistikTables() || []).map(x => String(x).toLowerCase()),digitCount};for (let i = 0; i < sampleSize; i++){const formula = this.generateRandomFormula(config);results.total++;if (this.isFormulaLikelyValid(formula)) results.valid++;}return results;},generateRandomFormula: function(config){const comp = config.comps[(Math.random() * config.comps.length) | 0];const offset = ((Math.random() * config.maxOffset) | 0)+1;const mistik = config.mistiks.length ? config.mistiks[(Math.random() * config.mistiks.length) | 0] : '';const operators = ['','+','-'];const operator = operators[(Math.random() * operators.length) | 0];let formula = `${comp}${offset}${mistik}`;if (operator && Math.random() > 0.5){const comp2 = config.comps[(Math.random() * config.comps.length) | 0];const offset2 = ((Math.random() * config.maxOffset) | 0)+1;const mistik2 = config.mistiks.length ? config.mistiks[(Math.random() * config.mistiks.length) | 0] : '';formula += `${operator}${comp2}${offset2}${mistik2}`;}if (config.mistiks.length && Math.random() > 0.75){const finalM = config.mistiks[(Math.random() * config.mistiks.length) | 0];if (finalM && finalM !== 'ix') formula += `.(${finalM})`;}return formula;},isFormulaLikelyValid: function(formula){try{const base = String(formula || '').replace(/\.\([^)]+\)$/,'').trim();if (base.includes('-')){const parts = base.split(/[+\-]/);if (parts.length >= 2 && parts[0] === parts[1]) return false;}return true;}catch (e){return false;}},setupEstimationUI: function(){try{let statusDiv = document.getElementById('estimationStatus');if (!statusDiv){statusDiv = document.createElement('div');statusDiv.id = 'estimationStatus';statusDiv.className = 'estimation-status';const statusInfo = document.getElementById('statusInfo');if (statusInfo && statusInfo.parentNode){statusInfo.parentNode.insertBefore(statusDiv,statusInfo.nextSibling);}else{document.body.appendChild(statusDiv);}}this.estimationSystem.ui.displayElement = statusDiv;}catch (e){}},updateEstimationUI: function(){const sys = this.estimationSystem;if (!sys || !sys.ui || !sys.ui.displayElement) return;const now = Date.now();if (!sys.ui.forceUpdate && now - (sys.ui.lastUiUpdate || 0) < 500) return;sys.ui.lastUiUpdate = now;sys.ui.forceUpdate = false;const formatNum = (num) =>{if (!num) return '0';if (num >= 1000000) return (num / 1000000).toFixed(1)+'M';if (num >= 1000) return (num / 1000).toFixed(1)+'K';return Number(num).toLocaleString();};const phase = sys.phases ||{};const totalText = this.totalCombinationsIsEstimate ? `~${formatNum(this.totalCombinations)}` : formatNum(this.totalCombinations);sys.ui.displayElement.innerHTML = ``;sys.ui.displayElement.style.borderLeftColor = confidenceColor;this.updateProgressBarWithEstimation();},updateProgressBarWithEstimation: function(){const processed = this.totalProcessed || 0;const total = this.totalCombinations || 1;const rawPercent = (processed / total) * 100;const percent = Math.min(100,Math.max(0,rawPercent));const fill = document.getElementById('progressFill');const percentText = document.getElementById('progressPercent');if (fill){fill.style.width = `${percent}%`;}if (percentText){if (this.totalCombinationsIsEstimate){percentText.innerHTML = `${Math.round(percent)}%<br><small>~${this.shortNum(total)}</small>`;}else{percentText.textContent = `${Math.round(percent)}%`;}}},startNewSession: function(){if (!this.isSearching || this.stopRequested) return;this.currentSession++;this.processedInSession = 0;this.recoveryAttempted = false;this.updateProgress();this.updateStatusInfo();this.appendResultPlain(`\nüöÄ Memulai sesi ${this.currentSession}...\n`);setTimeout(() =>{this.processBatch();},500);},_lazyShuffleBuffer: [],_lazyShuffleEnabled: false,_lazyShuffleBufferSize: 5000,_getNextLazyFormula: function(){if (!this._lazyShuffleEnabled){const n = this.aiFormulaIterator?.next?.() ||{done: true};return n;}if (!this._lazyShuffleBuffer || this._lazyShuffleBuffer.length === 0){const buf = [];const max = Math.max(100,this._lazyShuffleBufferSize || 5000);for (let i = 0; i < max; i++){const n = this.aiFormulaIterator?.next?.() ||{done: true};if (n.done) break;buf.push(n.value);}if (buf.length === 0){return{done: true};}for (let i = buf.length - 1; i > 0; i--){const j = Math.floor(Math.random() * (i+1));const tmp = buf[i];buf[i] = buf[j];buf[j] = tmp;}this._lazyShuffleBuffer = buf;}const value = this._lazyShuffleBuffer.shift();return{done: false,value};},processBatch: function(){try{if (this.stopRequested || !this.isSearching){this.finishSession();return;}if (this.paused){return;}const useLazyIterator = !!enableTriple || !!this.lazy12Enabled;if (!useLazyIterator && this.currentFormulaIndex >= this.aiFormulas.length){this.finishSearch();return;}if (this.processedInSession >= this.COMBINATIONS_PER_SESSION){this.finishSession();return;}const daysToPredict = parseInt(document.getElementById('daysToPredict').value,10) || 16;const targetType = document.getElementById('targetType').value;let currentBatchSize = this.BATCH_SIZE;const batchEl = document.getElementById('batchSize');if (batchEl){const v = parseInt(batchEl.value,10);if (!isNaN(v) && v > 0 && v !== currentBatchSize){console.log(`üîÑ Batch size updated in-process: ${currentBatchSize}‚Üí ${v}`);currentBatchSize = v;this.BATCH_SIZE = v;}}if (this._debugMode){try{const pct = (this.totalCombinations > 0)? Math.round((Math.min(this.totalProcessed,this.totalCombinations) / this.totalCombinations) * 100): 0;console.log(``);}catch (e){}}let processedInBatch = 0;let errorCount = 0;let sessionEndedInBatch = false;while (processedInBatch < currentBatchSize){if (this.paused || this.stopRequested || !this.isSearching) break;if (this.stopRequested || !this.isSearching) break;if (!useLazyIterator && this.currentFormulaIndex >= this.aiFormulas.length){break;}if (this.processedInSession >= this.COMBINATIONS_PER_SESSION){sessionEndedInBatch = true;break;}let aiFormula;if (useLazyIterator){if (!this.currentFormula || this.currentPatternIndex >= this.allPatterns.length){const next = this._getNextLazyFormula();if (next.done){this.finishSearch();return;}this.currentFormula = next.value;this.currentPatternIndex = 0;}aiFormula = this.currentFormula;}else{if (this.currentFormulaIndex >= this.aiFormulas.length){this.finishSearch();return;}aiFormula = this.aiFormulas[this.currentFormulaIndex];}const pattern = this.allPatterns[this.currentPatternIndex];try{const result = this.testCombination(aiFormula,pattern,this.dataHistory,daysToPredict,this.currentPatahLimit,targetType);if (result && result.passed){if (this.estimationSystem && this.estimationSystem.counters){this.estimationSystem.counters.valid++;}const normalizedAIFormula = this.normalizeAIFormula(this.stripFinalIX(aiFormula)).trim();if (normalizedAIFormula.startsWith('-')){}else{const dedupeKey = `${normalizedAIFormula}|${targetType}`;if (!this.uniqueAIFormulas.has(dedupeKey)){this.uniqueAIFormulas.add(dedupeKey);result.aiFormula = normalizedAIFormula;result.fullFormula = `${normalizedAIFormula}${pattern}`;this.foundResults.push(result);document.getElementById('foundCount').textContent = this.foundResults.length;try{this.updateStatusInfoSearchingLight();}catch(e){}this.displayResult(result);if (this.stopAfterCount !== null && this.stopAfterCount > 0){if (this.foundResults.length >= this.stopAfterCount){this.showNotification(`üéâ Berhasil menemukan ${this.stopAfterCount}rumus! Pencarian dihentikan otomatis.`,'success');this.appendResultPlain(`\nüõë BERHENTI OTOMATIS: Sudah menemukan ${this.stopAfterCount}rumus valid.\n`);this.stopSearch(true);return;}}}}}errorCount = 0;}catch (e){errorCount++;if (errorCount > 100){console.warn('',e.message);break;}}this.processedInSession++;this.totalProcessed++;if (this.estimationSystem && this.estimationSystem.counters){this.estimationSystem.counters.processed++;this.estimationSystem.counters.lastUpdate = Date.now();}processedInBatch++;this.currentPatternIndex++;if (!useLazyIterator && this.currentPatternIndex >= this.allPatterns.length){this.currentPatternIndex = 0;this.currentFormulaIndex++;if (this.currentFormulaIndex >= this.aiFormulas.length){break;}}if (this.processedInSession % 10000 === 0){this.updateProgress();if (this.processedInSession % 100000 === 0){this.saveProgress();}}}document.getElementById('processedCount').textContent = this.totalProcessed.toLocaleString();if (processedInBatch > 500000){this.cleanupMemory();}if (!useLazyIterator && this.currentFormulaIndex >= this.aiFormulas.length){this.finishSearch();return;}if (sessionEndedInBatch || this.processedInSession >= this.COMBINATIONS_PER_SESSION){this.finishSession();return;}if (this.isSearching && !this.stopRequested){if (this.estimationSystem && this.totalProcessed && (this.totalProcessed % 10000 === 0)){if (this.estimationSystem.ui) this.estimationSystem.ui.forceUpdate = true;if (typeof this.updateEstimationUI === "function") this.updateEstimationUI();}if (this.batchTimerId){clearTimeout(this.batchTimerId); this.batchTimerId = null;}this.batchTimerId = setTimeout(() =>{this.processBatch();},0);}else{console.log('Not scheduling next batch - isSearching:',this.isSearching,'stopRequested:',this.stopRequested);}}catch (error){console.error('Error in processBatch:',error);if (!this.recoveryAttempted){this.recoveryAttempted = true;this.showNotification('Error terjadi,mencoba recovery...','warning');setTimeout(() =>{this.cleanupMemory();this.processBatch();},1000);}else{this.showNotification('Error kritis: '+error.message,'error');this.stopSearch();}}},finishSession: function(){if (!this.isSearching) return;if (autoContinue){this.saveProgress();this.cleanupMemory();if (this.deferDetailedOutput) this.flushFinalOutputPartial(true);this.isSearching = false;this.paused = false;this._statusSearchingBuilt = false;this.stopRequested = false;document.getElementById('searchBtn').disabled = true;document.getElementById('stopBtn').disabled = true;document.getElementById('continueBtn').disabled = true;setTimeout(() =>{this.stopRequested = false;this.isSearching = true;this.processedInSession = 0;document.getElementById('stopBtn').disabled = false;this.startNewSession();},5000);}else{this.isSearching = false;this.stopRequested = false;document.getElementById('searchBtn').disabled = false;document.getElementById('stopBtn').disabled = true;document.getElementById('continueBtn').disabled = false;this.saveProgress();this.appendResultPlain(`\n‚è∏Ô∏è Sesi ${this.currentSession}selesai. Klik LANJUT untuk sesi ${this.currentSession+1}\n`);}this.updateProgress();},continueSearch: function(){;if (!this.paused && this.isSearching){console.log('!');this.showNotification('‚ö†Ô∏è Proses sedang berjalan!','warning');return;}this.paused = false;this.stopRequested = false;this.visibilityPaused = false;const batchEl = document.getElementById('batchSize');if (batchEl){const v = parseInt(batchEl.value,10);if (!isNaN(v) && v > 0 && v !== this.BATCH_SIZE){console.log(`üîÑ Batch size changed: ${this.BATCH_SIZE}‚Üí ${v}`);this.BATCH_SIZE = v;this.showNotification(`Batch size diubah ke ${v.toLocaleString()}`,'info');}}const useLazyIterator = !!enableTriple || !!this.lazy12Enabled;if (!useLazyIterator && this.currentFormulaIndex >= this.aiFormulas.length){;this.showNotification('‚úÖ Pencarian sudah selesai!','info');this.finishSearch();return;}console.log(``);this.isSearching = true;const searchBtn = document.getElementById('searchBtn');const stopBtn = document.getElementById('stopBtn');const continueBtn = document.getElementById('continueBtn');if (searchBtn) searchBtn.disabled = true;if (stopBtn) stopBtn.disabled = false;if (continueBtn) continueBtn.disabled = true;this.appendResultPlain(`\n‚ñ∂Ô∏è Melanjutkan pencarian (resume) dari sesi ${this.currentSession}...\n`);if (this.batchTimerId){clearTimeout(this.batchTimerId); this.batchTimerId = null;}setTimeout(() =>{this.processBatch();},0);},stopSearch: function(silent = false){console.log('',silent);if (!this.isSearching){;return;}this.stopRequested = true;this.isSearching = false;if (this.animationFrameId){cancelAnimationFrame(this.animationFrameId);this.animationFrameId = null;}if (this.batchTimerId){clearTimeout(this.batchTimerId);this.batchTimerId = null;}this.saveProgress();document.getElementById('searchBtn').disabled = false;document.getElementById('stopBtn').disabled = true;document.getElementById('continueBtn').disabled = false;if (!silent){this.visibilityPaused = false;const sessionProgress = (this.processedInSession / this.COMBINATIONS_PER_SESSION) * 100;this.appendResultPlain(`\n‚èπÔ∏è Proses dihentikan (sesi ${this.currentSession}: ${Math.round(sessionProgress)}%). ${this.foundResults.length}rumus ditemukan.\n`);this.updateProgress();this.showNotification('‚èπÔ∏è Pencarian dihentikan. Progress telah disimpan.','info');}else{;this.updateProgress();}try{this.updateStatusInfoSearchingLight();}catch(e){}},finishSearch: function(){this.isSearching = false;this.stopRequested = false;document.getElementById('searchBtn').disabled = false;document.getElementById('stopBtn').disabled = true;document.getElementById('continueBtn').disabled = true;const elapsed = Math.floor((Date.now() - this.startTime) / 1000);let block = '';;if (this.foundResults.length > 0){;}this.appendResultPlain(block);if (this.deferDetailedOutput) this.flushFinalOutputPartial(true);this.deferDetailedOutput = false;this.flushFinalOutput();localStorage.removeItem('prediksi_progress');this.showNotification('Pencarian selesai! '+this.foundResults.length+' rumus ditemukan.','success');try{this.updateStatusInfoSearchingLight();}catch(e){}},displayResult: function(result){const suffix = this.getSuffixForTargetType(result.targetType);if (result){if (result.aiFormula){result.aiFormula = this.stripFinalIX(result.aiFormula);}if (result.fullFormula){result.fullFormula = this.stripFinalIX(result.fullFormula);}}const resultNumber = this.foundResults.length;let resultHTML = ``;const __preds = (result.predictions || []).slice().reverse();for (let i = 0; i < __preds.length; i++){const p = __preds[i];const coloredPrediction = this.formatPredictionWithColors(p.prediction,p.checkResult,false);const symbol = p.hit ? '':'';resultHTML += ``;}const lastIndex = this.dataHistory.length - 1;const currentInput = this.dataHistory[lastIndex];try{const aiFormulaSafe = result.aiFormula ? this.stripFinalIX(result.aiFormula) : result.aiFormula;const ai = this.calculateAI(aiFormulaSafe,lastIndex,this.dataHistory);let pred;const baseTT2 = this.getBaseTargetType(result.targetType);if ([''].includes(baseTT2)){const aiDigit = String(ai);;}else if ([''].includes(baseTT2)){const aiDigit = String(ai);;}else if ([''].includes(baseTT2)){;}else{const rotation = this.generateRotation(ai);pred = this.applyPatternToRotation(rotation,result.pattern);}this.pushLiveFinding(result.aiFormula || result.fullFormula || '',result.pattern || '',pred || '');let checkResult ={targetType: result.targetType,matchedDetails: [],hit: false};let symbol = '';if (lastIndex+1 < this.dataHistory.length){const nextData = this.dataHistory[lastIndex+1];const targetDigits = this.getTargetDigits(nextData,result.targetType);checkResult = this.checkPrediction(pred,targetDigits,result.targetType,nextData);symbol = checkResult.hit ? '':'';}const coloredPrediction = this.formatPredictionWithColors(pred,checkResult,true);resultHTML += `${currentInput}= ${coloredPrediction}${suffix}${symbol}\n`;}catch (e){console.error('Error in displayResult:',e);resultHTML += ``;};this.appendResultHTML(resultHTML);this.saveResultForCopy(result);},saveResultForCopy: function(result){if (!result.copyData){result.copyData = [];}if (result && result.aiFormula){result.aiFormula = this.stripFinalIX(result.aiFormula);}if (result && result.fullFormula){result.fullFormula = this.stripFinalIX(result.fullFormula);}const __preds = (result.predictions || []).slice().reverse();for (let i = 0; i < __preds.length; i++){const p = __preds[i];const coloredPrediction = this.formatPredictionWithColors(p.prediction,p.checkResult,false);const plainText = coloredPrediction.replace(/<[^>]*>/g,'');const status = p.hit ? this.getSuffixForTargetType(result.targetType) : 'x';result.copyData.push(`${p.input}= ${plainText}${status}`);}},copyOutput: function(){let copyText = '';for (let i = 0; i < this.foundResults.length; i++){const result = this.foundResults[i];if (i > 0) copyText += '\n';const __preds = (result.predictions || []).slice().reverse();for (let j = 0; j < __preds.length; j++){const p = __preds[j];const status = p.hit ? this.getSuffixForTargetType(result.targetType) : 'x';copyText += `${p.input}= ${p.prediction}${status}\n`;}const lastIndex = this.dataHistory.length - 1;if (lastIndex >= 0){const suffix = this.getSuffixForTargetType(result.targetType);try{const ai = this.calculateAI(result.aiFormula,lastIndex,this.dataHistory);let pred;if ([''].includes(this.getBaseTargetType(result.targetType))){;;}else{const rotation = this.generateRotation(ai);pred = this.applyPatternToRotation(rotation,result.pattern);};}catch (e){;}};};},copyOutputMulti: function(){if (this.foundResults.length === 0){;return;}const predictionsByInput ={};const patahByInput ={};const orderedInputs = [];const seen = new Set();const first = this.foundResults[0];const __firstPreds = (first && Array.isArray(first.predictions)) ? first.predictions.slice().reverse() : [];for (const p of __firstPreds){if (!seen.has(p.input)){orderedInputs.push(p.input);seen.add(p.input);}if (!predictionsByInput[p.input]) predictionsByInput[p.input] = [];if (!patahByInput[p.input]) patahByInput[p.input] = [];}const lastInput = this.dataHistory[this.dataHistory.length - 1];if (lastInput && !seen.has(lastInput)){orderedInputs.push(lastInput);seen.add(lastInput);}if (lastInput && !predictionsByInput[lastInput]) predictionsByInput[lastInput] = [];if (lastInput && !patahByInput[lastInput]) patahByInput[lastInput] = [];for (let i = 0; i < this.foundResults.length; i++){const result = this.foundResults[i];for (const pred of result.predictions){if (!predictionsByInput[pred.input]) predictionsByInput[pred.input] = [];if (!patahByInput[pred.input]) patahByInput[pred.input] = [];predictionsByInput[pred.input][i] = pred.prediction;patahByInput[pred.input][i] = !pred.hit;}if (lastInput){try{const lastIndex = this.dataHistory.length - 1;const ai = this.calculateAI(result.aiFormula,lastIndex,this.dataHistory);let predLast;if ([''].includes(this.getBaseTargetType(result.targetType))){;;}else{const rotation = this.generateRotation(ai);predLast = this.applyPatternToRotation(rotation,result.pattern);}predictionsByInput[lastInput][i] = predLast;patahByInput[lastInput][i] = false;}catch (e){predictionsByInput[lastInput][i] = '?';patahByInput[lastInput][i] = false;}}}let copyText = '';const suffix = this.getSuffixForTargetType(this.foundResults[0]?.targetType || 'KE');const digitCount = parseInt(document.getElementById('digitCount').value,10) || 1;;function getPatahSymbol(dc,isShio){if (!isShio){if (dc === 1) return '√ó';let s = '';for (let i = 0; i < dc; i++){s += (i % 2 === 0) ? 'X':'x';}return s;}const n = Math.max(1,Math.min(12,dc || 1));return Array.from({length: n},() => 'XX').join(' ');}for (const input of orderedInputs){const preds = predictionsByInput[input] || [];let combinedPreds = '';for (let i = 0; i < this.foundResults.length; i++){if (i > 0) combinedPreds += ' . ';const isLastRow = (input === lastInput);const isPatah = patahByInput[input] && patahByInput[input][i] === true;if (isLastRow){if (preds[i] !== undefined && preds[i] !== '?' && preds[i] !== null && preds[i] !== ''){combinedPreds += preds[i];}else{try{const r = this.foundResults[i];const idx = this.dataHistory.length - 1;const ai = this.calculateAI(r.aiFormula,idx,this.dataHistory);let predLast;if ([''].includes(this.getBaseTargetType(r.targetType))){;predLast = this.applyPatternToRotationShio(rot12,r.pattern);}else{const rotation = this.generateRotation(ai);predLast = this.applyPatternToRotation(rotation,r.pattern);}combinedPreds += predLast;}catch (e){const lastPred = this.foundResults[i]?.predictions?.length? this.foundResults[i].predictions[this.foundResults[i].predictions.length - 1].prediction: null;;}}}else{if (isPatah){;}else{;}}};};for (let i = 0; i < this.foundResults.length; i++){;};},copyToClipboard: function(text,successMessage){if (!text.trim()){;return;}navigator.clipboard.writeText(text).then(() =>{this.showNotification(successMessage,'success');}).catch(() =>{const ta = document.createElement('textarea');ta.value = text;document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);this.showNotification(successMessage,'success');});},updateProgress: function(force){force = !!force;const __now = Date.now();if (!force){if (this._lastUIUpdate && (__now - this._lastUIUpdate) < 250){this._pendingUIUpdate = true;return;}}this._lastUIUpdate = __now;this._pendingUIUpdate = false;if (this.isSearching){try{const processed = this.totalProcessed || 0;const total = this.totalCombinations || 0;const rawPct = total > 0 ? (processed / total) * 100 : 0;const pct = Math.min(rawPct,100);const fill = document.getElementById('progressFill');if (fill) fill.style.width = `${pct}%`;const pctEl = document.getElementById('progressPercent');if (pctEl){if (this.totalCombinationsIsEstimate && total > 0 && processed > total){pctEl.textContent = `>100%`;}else{pctEl.textContent = `${Math.round(pct)}%`;}}const pc = document.getElementById('processedCount');if (pc) pc.textContent = processed.toLocaleString();const fc = document.getElementById('foundCount');if (fc) fc.textContent = (this.foundResults ? this.foundResults.length : 0);}catch (e){}try{this.updateStatusInfoSearchingLight();}catch(e){}return;}const total = this.totalCombinations || 0;const processed = this.totalProcessed || 0;const rawPct = total > 0 ? (processed / total) * 100 : 0;const pct = Math.min(rawPct,100);document.getElementById('progressFill').style.width = `${pct}%`;document.getElementById('progressPercent').textContent =(this.totalCombinationsIsEstimate && total > 0 && processed > total) ? `>100%` : `${Math.round(pct)}%`;const sessionProgress = this.COMBINATIONS_PER_SESSION > 0? (this.processedInSession / this.COMBINATIONS_PER_SESSION) * 100: 0;const statusDiv = document.getElementById('statusInfo');let html = '';if (this.isSearching){html += `<div class="info-line"><span class="info-label">Sesi:</span><span class="info-value">${this.currentSession}/${(Number.isFinite(this.totalSessions) ? this.totalSessions : '-')}</span></div><div class="info-line"><span class="info-label">Progress Sesi:</span><span class="info-value">${Math.round(sessionProgress)}%</span></div><div class="info-line"><span class="info-label">Total Progress:</span><span class="info-value">${Math.round(progress)}%</span></div><div class="info-line"><span class="info-label">Ditemukan:</span><span class="info-value info-success">${this.foundResults.length}rumus</span></div><div class="info-line"><span class="info-label">Diproses:</span><span class="info-value">${this.totalProcessed.toLocaleString()}</span></div>`;if (this.startTime && this.totalProcessed > 100){const elapsedMs = Date.now() - this.startTime;const combinationsPerMs = this.totalProcessed / elapsedMs;const remaining = this.totalCombinations - this.totalProcessed;const etaMs = remaining / combinationsPerMs;if (etaMs > 0 && etaMs < 86400000){const etaMinutes = Math.round(etaMs / 60000);;}}{;;;;;}}else{html += `<div class="info-line"><span class="info-label">Status:</span><span class="info-value">Siap</span></div><div class="info-line"><span class="info-label">Data:</span><span class="info-value">${this.dataHistory.length}angka</span></div><div class="info-line"><span class="info-label">Hasil Tersimpan:</span><span class="info-value">${this.foundResults.length}rumus</span></div>`;}statusDiv.innerHTML = html;},updateStatusInfoSearchingLight: function(){const statusDiv = document.getElementById('statusInfo');if (!statusDiv) return;if (!this._statusInfoSearchingInited){statusDiv.innerHTML = `<div class="info-line"><span class="info-label">Status:</span><span class="info-value info-success" id="si_status">Mencari...</span></div><div class="info-line"><span class="info-label">Sesi:</span><span class="info-value" id="si_sesi">0/0</span></div><div class="info-line"><span class="info-label">Progress Sesi:</span><span class="info-value" id="si_sesi_pct">0%</span></div><div class="info-line"><span class="info-label">Total Progress:</span><span class="info-value" id="si_total_pct">0%</span></div><div class="info-line"><span class="info-label">Ditemukan:</span><span class="info-value info-success" id="si_found">0 rumus</span></div><div class="info-line"><span class="info-label">Diproses:</span><span class="info-value" id="si_processed">0</span></div><div class="info-line"><span class="info-label">Target:</span><span class="info-value" id="si_target">-</span></div><div class="info-line"><span class="info-label">Batch:</span><span class="info-value" id="si_batch">-</span></div>`;this._statusInfoSearchingInited = true;}const processed = this.totalProcessed || 0;const total = this.totalCombinations || 0;const totalPct = total > 0 ? Math.min(100,(processed / total) * 100) : 0;const sessTotal = this.COMBINATIONS_PER_SESSION || 0;const sessPct = sessTotal > 0 ? Math.min(100,(this.processedInSession || 0) / sessTotal * 100) : 0;const elSesi = document.getElementById('si_sesi');if (elSesi) elSesi.textContent = `${this.currentSession || 0}/${this.totalSessions || 0}`;const elSessPct = document.getElementById('si_sesi_pct');if (elSessPct) elSessPct.textContent = `${Math.round(sessPct)}%`;const elTotalPct = document.getElementById('si_total_pct');if (elTotalPct) elTotalPct.textContent = `${Math.round(totalPct)}%`;const elFound = document.getElementById('si_found');if (elFound) elFound.textContent = `${(this.foundResults ? this.foundResults.length : 0)}rumus`;const elProcessed = document.getElementById('si_processed');if (elProcessed) elProcessed.textContent = processed.toLocaleString();const tt = document.getElementById('targetType')?.value || '';const elTarget = document.getElementById('si_target');if (elTarget) elTarget.textContent = this.getTargetTypeName ? this.getTargetTypeName(tt) : (tt || '-');const elBatch = document.getElementById('si_batch');if (elBatch) elBatch.textContent = (this.BATCH_SIZE || 0).toLocaleString();},updateStatusInfo: function(){if (this.isSearching) return;this._statusInfoSearchingInited = false;const input = document.getElementById('inputNumbers').value.trim();const lines = input.split('\n').map(l => l.trim()).filter(l => /^\d{4}$/.test(l));const dataCount = lines.length;const daysToPredict = parseInt(document.getElementById('daysToPredict').value,10) || 10;const patah = document.getElementById('patahLimit').value;const targetType = document.getElementById('targetType').value;const enableTriple = document.getElementById('enableTriple')?.checked ? true : false;let html = `<div class="info-line"><span class="info-label">Data Tersedia:</span><span class="info-value">${dataCount}angka</span></div><div class="info-line"><span class="info-label">Hari Prediksi:</span><span class="info-value">${daysToPredict}hari</span></div><div class="info-line"><span class="info-label">Target:</span><span class="info-value">${this.getTargetTypeName(targetType)}</span></div><div class="info-line"><span class="info-label">Batas Patah:</span><span class="info-value">${patah === '' ? '0' : patah}x</span></div><div class="info-line"><span class="info-label">Mode Pencarian:</span><span class="info-value">LENGKAP</span></div><div class="info-line"><span class="info-label">3 Kombinasi:</span><span class="info-value">${enableTriple ? 'AKTIF':'OFF'}</span></div><div class="info-line"><span class="info-label">Batch Size:</span><span class="info-value">${this.BATCH_SIZE.toLocaleString()}</span></div>`;if (this.foundResults.length > 0){html += `<div class="info-line"><span class="info-label info-success">Hasil Tersimpan:</span><span class="info-value info-success">${this.foundResults.length}rumus</span></div>`;}document.getElementById('statusInfo').innerHTML = html;},cleanupMemory: function(){try{if (this._patternStepsCache.size > 10000){this._patternStepsCache.clear();}if (this._formulaParseCache.size > 5000){this._formulaParseCache.clear();}for (let result of this.foundResults){if (result){if (result.aiFormula) result.aiFormula = this.stripFinalIX(result.aiFormula);if (result.fullFormula) result.fullFormula = this.stripFinalIX(result.fullFormula);}if (result.predictions && result.predictions.length > 30){result.predictions = result.predictions.slice(-15);}}if (this.foundResults.length > 1000){this.foundResults = this.foundResults.slice(-500);}}catch (e){console.warn('Error in cleanupMemory:',e);}if (window.gc){try{window.gc();}catch(e){}}if (this.estimationSystem?.continuousInterval){clearInterval(this.estimationSystem.continuousInterval);this.estimationSystem.continuousInterval = null;}if (!this.isSearching && this.estimationSystem){this.estimationSystem.phases.adaptive = null;this.estimationSystem.counters ={generated: 0,processed: 0,valid: 0,lastUpdate: Date.now()};}},autoSaveInput: function(){try{const inputData = document.getElementById('inputNumbers').value;if (inputData.trim()){localStorage.setItem('prediksi_input',inputData);console.log(':',new Date().toLocaleTimeString());}}catch (e){console.warn(':',e);}},saveSettings: function(){try{const settings ={version: '3.0',timestamp: Date.now(),daysToPredict: document.getElementById('daysToPredict').value,digitCount: document.getElementById('digitCount').value,patah: document.getElementById('patahLimit').value,targetType: document.getElementById('targetType').value,};localStorage.setItem('prediksi_settings',JSON.stringify(settings));}catch (e){;}},loadSettings: function(){try{const saved = localStorage.getItem('prediksi_settings');if (saved){const settings = JSON.parse(saved);if (settings.version === '3.0'){document.getElementById('daysToPredict').value = settings.daysToPredict || '10';document.getElementById('digitCount').value = settings.digitCount || '1';document.getElementById('patahLimit').value = settings.patah || '';document.getElementById('targetType').value = settings.targetType || 'KE';;;;{;}}}}catch (e){console.warn(':',e);}},saveProgress: function(){const ta = document.getElementById('inputNumbers');if (ta && ta.value.trim()){const lines = ta.value.trim().split('\n').map(l => l.trim()).filter(l => /^\d{4}$/.test(l));if (lines.length > 0){this.dataHistory = lines;}}this.autoSaveInput();this.saveSettings();const safeFound = this.foundResults.map(r =>{const rr = Object.assign({},r);if (rr.aiFormula) rr.aiFormula = this.stripFinalIX(rr.aiFormula);if (rr.fullFormula) rr.fullFormula = this.stripFinalIX(rr.fullFormula);delete rr.predictions;delete rr.copyData;return rr;});const progressData ={version: '3.0',timestamp: Date.now(),dataHistory: this.dataHistory,aiFormulas: this.aiFormulas.slice(0,1000),allPatterns: this.allPatterns,foundResults: safeFound,uniqueAIFormulas: Array.from(this.uniqueAIFormulas).slice(0,500),currentSession: this.currentSession,processedInSession: this.processedInSession,totalProcessed: this.totalProcessed,totalCombinations: this.totalCombinations,currentFormulaIndex: this.currentFormulaIndex,currentPatternIndex: this.currentPatternIndex,isSearching: this.isSearching,stopRequested: this.stopRequested,};try{const jsonString = JSON.stringify(progressData);if (jsonString.length > this.PERSISTENCE_CONFIG.MAX_SAVE_SIZE){console.warn('Data terlalu besar,melakukan optimasi...');progressData.aiFormulas = [];progressData.allPatterns = [];progressData.foundResults = progressData.foundResults.slice(0,50);const compressedString = JSON.stringify(progressData);localStorage.setItem('prediksi_progress',compressedString);}else{localStorage.setItem('prediksi_progress',jsonString);}console.log('‚úÖ Progress disimpan:',new Date().toLocaleTimeString());}catch (e){console.error('Gagal menyimpan progress:',e);try{const minimalData ={version: '3.0',timestamp: Date.now(),dataHistory: this.dataHistory,foundResults: safeFound.slice(0,10),currentSession: this.currentSession,totalProcessed: this.totalProcessed,isSearching: this.isSearching,batchSize: this.BATCH_SIZE};localStorage.setItem('prediksi_progress',JSON.stringify(minimalData));}catch (e2){;}}},loadProgress: function(){;const savedInput = localStorage.getItem('prediksi_input');if (savedInput){const ta = document.getElementById('inputNumbers');if (ta){ta.value = savedInput;this.updateDataCount();;}}const saved = localStorage.getItem('prediksi_progress');if (!saved){;this.loadSettings();return false;}try{const progressData = JSON.parse(saved);if (!progressData.version || !progressData.version.startsWith('3')){;this.loadSettings();return false;}this.dataHistory = Array.isArray(progressData.dataHistory)? progressData.dataHistory.filter(item => /^\d{4}$/.test(item)): [];const ta = document.getElementById('inputNumbers');if (ta && !ta.value.trim() && this.dataHistory.length > 0){ta.value = this.dataHistory.join('\n');this.updateDataCount();;}this.aiFormulas = Array.isArray(progressData.aiFormulas) ? progressData.aiFormulas : [];this.allPatterns = Array.isArray(progressData.allPatterns) ? progressData.allPatterns : [];this.foundResults = Array.isArray(progressData.foundResults)? progressData.foundResults.filter(r => r && r.fullFormula): [];this.uniqueAIFormulas = new Set();for (const r of this.foundResults){const fkey = this.normalizeAIFormula(this.stripFinalIX(r.aiFormula || r.fullFormula || ''));const tkey = r.targetType || '';if (fkey) this.uniqueAIFormulas.add(`${fkey}|${tkey}`);}this.currentSession = progressData.currentSession || 0;this.processedInSession = progressData.processedInSession || 0;this.totalProcessed = progressData.totalProcessed || 0;this.totalCombinations = progressData.totalCombinations || 0;this.currentFormulaIndex = progressData.currentFormulaIndex || 0;this.currentPatternIndex = progressData.currentPatternIndex || 0;this.isSearching = false;this.stopRequested = false;this.visibilityPaused = false;if (progressData.batchSize && !isNaN(progressData.batchSize)){this.BATCH_SIZE = progressData.batchSize;const batchEl = document.getElementById('batchSize');if (batchEl){batchEl.value = progressData.batchSize;}}this.loadSettings();document.getElementById('foundCount').textContent = this.foundResults.length;document.getElementById('processedCount').textContent = this.totalProcessed.toLocaleString();this.updateCombinationDisplay();const progress = this.totalCombinations > 0 ? (this.totalProcessed / this.totalCombinations) * 100 : 0;document.getElementById('progressFill').style.width = `${Math.min(progress,100)}%`;document.getElementById('progressPercent').textContent = `${Math.round(progress)}%`;document.getElementById('searchBtn').disabled = false;document.getElementById('stopBtn').disabled = true;document.getElementById('continueBtn').disabled = this.currentFormulaIndex >= this.aiFormulas.length;if (this.foundResults.length > 0){this.displayLoadedResults();}this.updateStatusInfo();if (this.continueTimeout){clearTimeout(this.continueTimeout);this.continueTimeout = null;}const date = new Date(progressData.timestamp).toLocaleString();this.showNotification(`üíæ Progress dimuat (tersimpan: ${date})`,'info');console.log('‚úÖ Progress berhasil dimuat');return true;}catch (error){;try{localStorage.setItem('prediksi_progress_corrupt_'+Date.now(),saved);}catch (e){}this.loadSettings();this.showNotification('Gagal memuat progress,tapi input tetap aman.','warning');return false;}},displayLoadedResults: function(){const pct = (this.totalCombinations > 0)? Math.round((this.totalProcessed / this.totalCombinations) * 100): 0;let output = '';;if (this.foundResults.length > 0){;const bestResults = [...this.foundResults].sort((a,b) =>{;;}).slice(0,5);bestResults.forEach((result,index) =>{const safeFormula = result.fullFormula ? this.stripFinalIX(result.fullFormula) : '';;});}this.setResultPlain(output);},clearAllData: function(){if (this.isSearching){this.showNotification('Hentikan proses terlebih dahulu!','warning');return;}if (!confirm('Hapus SEMUA data dan hasil?')) return;document.getElementById('inputNumbers').value = '';document.getElementById('resultOutput').innerHTML = '';document.getElementById('dataCount').textContent = '0';document.getElementById('formulaCount').textContent = '0';document.getElementById('processedCount').textContent = '0';document.getElementById('foundCount').textContent = '0';document.getElementById('progressFill').style.width = '0%';document.getElementById('progressPercent').textContent = '0%';document.getElementById('daysToPredict').value = '15';document.getElementById('digitCount').value = '4';document.getElementById('patahLimit').value = '';document.getElementById('targetType').value = 'KE';;{;;}this.resetSearchState();this.updateStatusInfo();localStorage.removeItem('prediksi_progress');localStorage.removeItem('prediksi_input');localStorage.removeItem('prediksi_settings');this.showNotification('Semua data telah dihapus.','info');},clearOutput: function(){if (this.isSearching){this.showNotification('Hentikan proses terlebih dahulu!','warning');return;}if (!confirm('Hapus semua hasil output?')) return;document.getElementById('resultOutput').innerHTML = '';this.showNotification('Output telah dihapus.','info');},showNotification: function(message,type = 'info'){const notification = document.getElementById('notification');notification.className = 'notification';notification.innerHTML = message;notification.classList.add(type);notification.classList.remove('hide');void notification.offsetWidth;setTimeout(() =>{notification.classList.add('show');if (this._notificationTimeout){clearTimeout(this._notificationTimeout);}this._notificationTimeout = setTimeout(() =>{notification.classList.remove('show');notification.classList.add('hide');setTimeout(() =>{notification.classList.remove('hide');},500);},5000);},10);},handleVisibilityChange: function(){;console.log('',this.visibilityPaused);if (document.hidden){;if (this.continueTimeout){clearTimeout(this.continueTimeout);this.continueTimeout = null;;}if (this.batchTimerId){clearTimeout(this.batchTimerId);this.batchTimerId = null;;}if (this.isSearching){;this.visibilityPaused = true;this.paused = true;this.flushFinalOutputPartial(false);this.saveProgress();this.isSearching = false;this.stopRequested = false;;}else{;}return;};if (this.visibilityPaused){this.visibilityPaused = false;}if (this.paused){;this.showNotification('‚è∏Ô∏è Proses di-pause otomatis. Klik LANJUT untuk melanjutkan.','info');const searchBtn = document.getElementById('searchBtn');const stopBtn = document.getElementById('stopBtn');const continueBtn = document.getElementById('continueBtn');if (searchBtn) searchBtn.disabled = false;if (stopBtn) stopBtn.disabled = true;if (continueBtn) continueBtn.disabled = false;this.appendResultPlain(`\n‚è∏Ô∏è Auto-pause: Tab tidak aktif. Klik LANJUT untuk melanjutkan.\n`);;}else{;}},handleBeforeUnload: function(event){if (this.isSearching){this.saveProgress();event.preventDefault();event.returnValue = 'Progress sedang berjalan. Tutup halaman?';}},resetSearchState: function(){this.dataHistory = [];this.aiFormulas = [];this.allPatterns = [];this.foundResults = [];this.uniqueAIFormulas.clear();this.isSearching = false;this.stopRequested = false;this.visibilityPaused = false;this.recoveryAttempted = false;this.currentPatahLimit = 0;this.totalCombinations = 0;this.currentSession = 0;this.totalSessions = 0;this.processedInSession = 0;this.totalProcessed = 0;this.currentFormulaIndex = 0;this.currentPatternIndex = 0;if (this.animationFrameId){cancelAnimationFrame(this.animationFrameId);this.animationFrameId = null;}if (this.batchInterval)if (this.batchTimerId){clearTimeout(this.batchTimerId);this.batchTimerId = null;}if (this.batchInterval){clearInterval(this.batchInterval);this.batchInterval = null;}if (this.continueTimeout){clearTimeout(this.continueTimeout);this.continueTimeout = null;}if (this._notificationTimeout){clearTimeout(this._notificationTimeout);this._notificationTimeout = null;}this._patternStepsCache.clear();this._formulaParseCache.clear();this._targetDigitsCache = null;},validateInputData: function(dataArray){const issues = [];const unique = [...new Set(dataArray)];if (unique.length !== dataArray.length){issues.push(`Terdapat ${dataArray.length - unique.length}data duplikat`);}let sequentialCount = 0;for (let i = 1; i < dataArray.length; i++){const prev = parseInt(dataArray[i-1]);const curr = parseInt(dataArray[i]);if (Math.abs(curr - prev) === 1) sequentialCount++;}if (sequentialCount > dataArray.length * 0.3){issues.push("Banyak angka berurutan - data mungkin kurang acak");}return issues;},};function startSearch(){RumusOtomatis.startSearch();}function stopSearch(){RumusOtomatis.stopSearch();}function continueSearch(){RumusOtomatis.continueSearch();}function clearAllData(){RumusOtomatis.clearAllData();}function clearOutput(){RumusOtomatis.clearOutput();}function copyOutput(){if (typeof showProModal === "function"){showProModal("OUTPUT (PRO)","Fitur PRO: Detail rumus lengkap,semua target (A/C/AC/CK/CB/J/JS),mode 3 komponen,semua mistik (M0-M10),shuffle/sesi besar,dan tombol salin otomatis.");}else{alert("Fitur Output Normal hanya tersedia di versi PRO.");}}function copyOutputMulti(){RumusOtomatis.copyOutputMulti();}document.addEventListener('DOMContentLoaded',function(){console.log('üöÄ Aplikasi Rumus Otomatis dimulai...');const savedInput = localStorage.getItem('prediksi_input');if (savedInput){const ta = document.getElementById('inputNumbers');if (ta){ta.value = savedInput;console.log('‚úÖ Input dimuat dari localStorage:',savedInput.split('\n').length,'baris');}}try{window._ix = RumusOtomatis.mistikTables.IX;window._ty = RumusOtomatis.mistikTables.TY;window._ml = RumusOtomatis.mistikTables.ML;window._mb = RumusOtomatis.mistikTables.MB;window._m9 = RumusOtomatis.mistikTables.M9;}catch (e){}RumusOtomatis.init();const autoContinueEl = document.getElementById('autoContinue');if (autoContinueEl){autoContinueEl.checked = false;}setInterval(() =>{RumusOtomatis.autoSaveInput();},10000);;if (typeof document.hidden !== 'undefined'){;document.addEventListener('visibilitychange',() =>{;RumusOtomatis.handleVisibilityChange();});;}else{;}window.addEventListener('blur',() =>{RumusOtomatis.autoSaveInput();RumusOtomatis.flushFinalOutputPartial(false);});window.addEventListener('beforeunload',(e) =>{RumusOtomatis.autoSaveInput();RumusOtomatis.flushFinalOutputPartial(false);RumusOtomatis.handleBeforeUnload(e);});window.addEventListener('pagehide',() =>{RumusOtomatis.autoSaveInput();RumusOtomatis.flushFinalOutputPartial(false);});setTimeout(() =>{const firstVisit = !localStorage.getItem('rumus_otomatis_visited');if (firstVisit){RumusOtomatis.showNotification('Selamat datang.','info');localStorage.setItem('rumus_otomatis_visited','true');}},1500);const singleOnlyEl = document.getElementById('enableSingleOnly');const singleOffsetEl = document.getElementById('singleOffset');const tripleEl = document.getElementById('enableTriple');function clampInt(v,lo,hi){const n = parseInt(v,10);if (isNaN(n)) return lo;return Math.max(lo,Math.min(hi,n));}function syncSingleOnlyUI(){const on = !!singleOnlyEl?.checked;if (singleOffsetEl){if (on){singleOffsetEl.disabled = false;singleOffsetEl.value = String(clampInt(singleOffsetEl.value,10,365));}else{singleOffsetEl.value = '10';singleOffsetEl.disabled = true;}}if (tripleEl){if (on){tripleEl.checked = false;tripleEl.disabled = true;}else{tripleEl.disabled = false;}}}if (singleOnlyEl){singleOnlyEl.addEventListener('change',() =>{syncSingleOnlyUI();if (window.RumusOtomatis?.updateCombinationDisplay){window.RumusOtomatis.updateCombinationDisplay();}});}if (singleOffsetEl){singleOffsetEl.addEventListener('input',() =>{let value = singleOffsetEl.value;if (value.trim() === ''){singleOffsetEl.value = '';if (window.RumusOtomatis?.updateCombinationDisplay){window.RumusOtomatis.updateCombinationDisplay();}return;}value = value.replace(/[^\d]/g,'').slice(0,3);singleOffsetEl.value = value;if (window.RumusOtomatis?.updateCombinationDisplay){window.RumusOtomatis.updateCombinationDisplay();}});singleOffsetEl.addEventListener('blur',() =>{let value = singleOffsetEl.value.trim();if (value === ''){singleOffsetEl.value = '';return;}singleOffsetEl.value = String(clampInt(value,10,365));if (window.RumusOtomatis?.updateCombinationDisplay){window.RumusOtomatis.updateCombinationDisplay();}});}const targetEl = document.getElementById('targetType');const digitEl = document.getElementById('digitCount');function syncSpecialDigit(){if (!targetEl || !digitEl) return;const t = String(targetEl.value || '').toUpperCase();const isLemah = window.RumusOtomatis?.isLemahTargetType? window.RumusOtomatis.isLemahTargetType(targetEl.value): t.startsWith('L');if (isLemah || isGG || isBK){;;}else{;}};;});;(() =>{'use strict';try{if (!window.RumusOtomatis && typeof RumusOtomatis !== 'undefined'){window.RumusOtomatis = RumusOtomatis;}}catch (e){}function getRO(){try{if (window.RumusOtomatis) return window.RumusOtomatis;}catch (e){}try{if (typeof RumusOtomatis !== 'undefined') return RumusOtomatis;}catch (e){}return null;}function showNotif(msg,type = 'info'){const ro = getRO();if (ro && typeof ro.showNotification === 'function'){ro.showNotification(msg,type);}else{alert(msg);}}function getFoundResults(){const ro = getRO();return ro ? (ro.foundResults || []) : [];}function getDataHistory(){const ro = getRO();return ro ? (ro.dataHistory || []) : [];}function calculatePrediction(aiFormula,pattern){const ro = getRO();try{const data = getDataHistory();if (!ro || !data || !data.length) return '?';const lastIndex = data.length - 1;const ai = ro.calculateAI(aiFormula,lastIndex,data);const targetType = ro.foundResults && ro.foundResults[0] ? ro.foundResults[0].targetType : '';const baseTargetType = ro.getBaseTargetType ? ro.getBaseTargetType(targetType) : targetType;let pred;if ([''].includes(baseTargetType)){;;}else{const rotation = ro.generateRotation(ai);pred = ro.applyPatternToRotation(rotation,pattern);}return pred;}catch (e){console.warn('',e && e.message ? e.message : e);return '?';}}function ensureTbody(){return document.getElementById('resultTableBody');}function renderEmptyMessage(tbody,message){tbody.innerHTML = '';const row = document.createElement('tr');row.innerHTML = `<td colspan="6" class="result-table-empty">${message}</td>`;tbody.appendChild(row);}window.rangkumRumus = function rangkumRumus(){try{const ro = getRO();if (!ro){;}const tbody = ensureTbody();if (!tbody){;return;}const results = getFoundResults();if (!results.length){showNotif('Belum ada rumus yang ditemukan!','warning');;return;}tbody.innerHTML = '';const maxDisplay = 1000;const displayResults = results.slice(0,maxDisplay);function extractDigitsOnly(pred){const s = String(pred ?? '');const groups = s.match(/\d+/g);if (!groups) return '';return groups.join('');}const digitFreq = Object.create(null);const rows = new Array(displayResults.length);for (let i = 0; i < displayResults.length; i++){const result = displayResults[i] ||{};const aiFormula = String(result.aiFormula || result.fullFormula || '').trim();const pattern = String(result.pattern || '').trim();const patah = (result.patah !== undefined && result.patah !== null) ? result.patah : 0;const prediction = calculatePrediction(aiFormula,pattern);const digitStr = extractDigitsOnly(prediction);for (let k = 0; k < digitStr.length; k++){const d = digitStr[k];digitFreq[d] = (digitFreq[d] || 0)+1;}rows[i] ={origIndex: i,aiFormula,pattern,patah,prediction,digitStr};}for (let i = 0; i < rows.length; i++){const r = rows[i];let maxFreq = 0;if (r.digitStr && r.digitStr.length){for (let k = 0; k < r.digitStr.length; k++){const d = r.digitStr[k];const f = digitFreq[d] || 0;if (f > maxFreq) maxFreq = f;}}let numValue = Number.POSITIVE_INFINITY;if (r.digitStr && r.digitStr.length){const n = parseInt(r.digitStr,10);numValue = Number.isFinite(n) ? n : Number.POSITIVE_INFINITY;}r._maxFreq = maxFreq;r._numValue = numValue;}rows.sort((a,b) =>{if (b._maxFreq !== a._maxFreq) return b._maxFreq - a._maxFreq;if (a._numValue !== b._numValue) return a._numValue - b._numValue;return a.origIndex - b.origIndex;});for (let i = 0; i < rows.length; i++){const r = rows[i];const row = document.createElement('tr');row.innerHTML = ``;tbody.appendChild(row);}setupSelectAll();if (results.length > maxDisplay){const infoRow = document.createElement('tr');infoRow.innerHTML = ``;tbody.appendChild(infoRow);};}catch (error){console.error('Fitur tersedia di versi PRO',error);;}};function setupSelectAll(){const selectAll = document.getElementById('selectAllRows');;{;;;;};}document.addEventListener('change',function(e){;;;;;;;});window.copySelectedRows = function copySelectedRows(){try{;{;return;}const results = getFoundResults();let copyText = '';selected.forEach(checkbox =>{const index = parseInt(checkbox.getAttribute('data-index'),10);if (!Number.isFinite(index) || index < 0 || index >= results.length) return;const result = results[index] ||{};const aiFormula = String().trim();const pattern = String().trim();const patah = (result.patah !== undefined && result.patah !== null) ? result.patah : 0;const targetType = String().trim() || '';const prediction = calculatePrediction(aiFormula,pattern);;});copyText = copyText.trim();if (!copyText){;}if (navigator.clipboard && window.isSecureContext){navigator.clipboard.writeText(copyText).then(() => showNotif(``,'success')).catch(() => fallbackCopy(copyText,selected.length));}else{fallbackCopy(copyText,selected.length);}}catch (error){;;}};function fallbackCopy(text,count){const textarea = document.createElement('textarea');textarea.value = text;textarea.style.position = 'fixed';textarea.style.opacity = '0';document.body.appendChild(textarea);textarea.select();try{document.execCommand('copy');;}catch (err){;}document.body.removeChild(textarea);}window.debugRumus = function debugRumus(){console.log('=== DEBUG RUMUS ===');console.log('window.RumusOtomatis:',window.RumusOtomatis);try{console.log('RumusOtomatis identifier:',(typeof RumusOtomatis !== 'undefined') ? RumusOtomatis : undefined);}catch (e){}console.log('Found Results:',getFoundResults());console.log('Data History:',getDataHistory());};})();function resetProgressOnly(){try{const RO = (typeof RumusOtomatis !== 'undefined' ? RumusOtomatis : (window.RumusOtomatis || null));if (!RO){alert(''); return;}if (RO.isSearching){RO.stopRequested = true;}try{localStorage.removeItem('prediksi_progress');}catch (e){}if (typeof RO.resetSearchState === 'function') RO.resetSearchState();if (typeof RO.updateProgress === 'function') RO.updateProgress();if (typeof RO.showNotification === 'function') RO.showNotification('Progress berhasil direset.','success');}catch (e){console.error('resetProgressOnly error:',e);try{alert('Gagal reset progres: '+e.message);}catch (_){}}};(function(){'use strict';function RO(){try{if (typeof RumusOtomatis !== 'undefined') return RumusOtomatis;}catch(e){}return window.RumusOtomatis || null;}const ro = RO();if (!ro) return;function tbody(){return document.getElementById('resultTableBody');}function selectAllEl(){return document.getElementById('selectAllRows');}function getCheckedCbs(){return Array.from(document.querySelectorAll('#resultTableBody .row-checkbox:checked'));}function notify(msg,type){try{if (ro && typeof ro.showNotification === 'function') ro.showNotification(msg,type||'info');else if (typeof showNotification === 'function') showNotification(msg,type||'info');else alert(msg);}catch(e){}}window.clearOutputTable = function(){const tb = tbody();if (tb) tb.innerHTML = '';const sa = selectAllEl();if (sa){sa.checked = false; sa.indeterminate = false;}};const _start = window.startSearch;if (typeof _start === 'function'){window.startSearch = function(){window.clearOutputTable();return _start.apply(this,arguments);};}const _cont = window.continueSearch;if (typeof _cont === 'function'){window.continueSearch = function(){window.clearOutputTable();return _cont.apply(this,arguments);};}function refreshSelectAllState(){const sa = selectAllEl();if (!sa) return;const all = Array.from(document.querySelectorAll('#resultTableBody .row-checkbox'));const checked = getCheckedCbs();if (!all.length){sa.checked = false; sa.indeterminate = false;return;}sa.checked = checked.length === all.length;sa.indeterminate = checked.length > 0 && checked.length < all.length;}function bindSelectAll(){const sa = selectAllEl();if (!sa) return;if (sa._bound) return;sa._bound = true;sa.addEventListener('change',function(){;all.forEach(cb =>{cb.checked = sa.checked;});refreshSelectAllState();});document.addEventListener('change',function(e){if (e && e.target && e.target.classList && e.target.classList.contains('')){refreshSelectAllState();}});}bindSelectAll();window.rangkumRumus = function(){try{const results = ro.foundResults || [];const tb = tbody();if (!tb){;return;}tb.innerHTML = '';const sa = selectAllEl();if (sa){sa.checked = false; sa.indeterminate = false;}if (!results.length){;return;}const data = ro.dataHistory || [];const lastIndex = data.length - 1;const maxDisplay = 1000;const display = results.slice(0,maxDisplay);function extractDigitsOnly(pred){const s = String(pred ?? '');const groups = s.match(/\d+/g);return groups ? groups.join('') : '';}const digitFreq = Object.create(null);const rows = new Array(display.length);for (let i=0;i<display.length;i++){const r = display[i] ||{};let pred = '?';try{if (data.length){const ai = ro.calculateAI(r.aiFormula,lastIndex,data);let predLocal;const baseTargetType = ro.getBaseTargetType ? ro.getBaseTargetType(r.targetType) : r.targetType;if ([''].includes(baseTargetType)){;;}else{const rot = ro.generateRotation(ai);predLocal = ro.applyPatternToRotation(rot,r.pattern);}pred = predLocal;}}catch(e){;pred = '?';}const digitStr = extractDigitsOnly(pred);for (let k=0;k<digitStr.length;k++){const d = digitStr[k];digitFreq[d] = (digitFreq[d] || 0)+1;}rows[i] ={origIndex: i,aiFormula: r.aiFormula || '',pattern: r.pattern || '',patah: (r.patah !== undefined && r.patah !== null) ? r.patah : 0,prediction: pred,digitStr};}for (let i=0;i<rows.length;i++){const rr = rows[i];let maxFreq = 0;if (rr.digitStr){for (let k=0;k<rr.digitStr.length;k++){const d = rr.digitStr[k];const f = digitFreq[d] || 0;if (f > maxFreq) maxFreq = f;}}let numValue = Number.POSITIVE_INFINITY;if (rr.digitStr){const n = parseInt(rr.digitStr,10);numValue = Number.isFinite(n) ? n : Number.POSITIVE_INFINITY;}rr._maxFreq = maxFreq;rr._numValue = numValue;}rows.sort((a,b)=>{if (b._maxFreq !== a._maxFreq) return b._maxFreq - a._maxFreq;if (a._numValue !== b._numValue) return a._numValue - b._numValue;return a.origIndex - b.origIndex;});let rowsHtml = '';for (let i=0;i<rows.length;i++){const rr = rows[i];const patah = rr.patah;;}tb.innerHTML = rowsHtml;if ((results.length||0) > maxDisplay){;}bindSelectAll();refreshSelectAllState();;}catch(err){console.error(err);;}};window.copySelectedRows = function(){;if (!cbs.length){;return;}const results = ro.foundResults || [];const data = ro.dataHistory || [];const lastIndex = data.length - 1;const targetType = (document.getElementById('') ||{}).value || '';const suffix = (typeof ro.getSuffixForTargetType === 'function') ? ro.getSuffixForTargetType(targetType) : 'ai';let text = '';cbs.forEach(cb =>{const idx = parseInt(cb.getAttribute('data-index'),10);const r = results[idx] ||{};let pred='?';try{if (data.length){const ai = ro.calculateAI(r.aiFormula,lastIndex,data);let predLocal;const baseTargetType = ro.getBaseTargetType ? ro.getBaseTargetType(r.targetType) : r.targetType;if ([''].includes(baseTargetType)){;;}else{const rot = ro.generateRotation(ai);predLocal = ro.applyPatternToRotation(rot,r.pattern);}pred = predLocal;}}catch(e){;pred='?';}const patah = (r.patah !== undefined && r.patah !== null) ? r.patah : 0;const suffixRow = (typeof ro.getSuffixForTargetType === 'function') ? ro.getSuffixForTargetType(r.targetType || targetType) : suffix;let predOut = pred;try{const baseTT = (typeof ro.getBaseTargetType === 'function') ? ro.getBaseTargetType(r.targetType || targetType) : (r.targetType || targetType);const baseTTU = String(baseTT || '').toUpperCase();const ps = String(predOut || '');if (ps && !ps.includes('_')){if ([''].includes(baseTTU)){}else if ([''].includes(baseTTU)){;}}}catch(e){};});;;};function withFilteredFoundResults(runFn){;if (!cbs.length){;}const orig = ro.foundResults;try{const selected = cbs.map(cb => orig[parseInt(cb.getAttribute('data-index'),10)]).filter(Boolean);ro.foundResults = selected;runFn();}finally{;}}window.copyOutput = function(){if (typeof ro.copyOutput === 'function'){;}else{}};window.copyOutputMulti = function(){if (typeof ro.copyOutputMulti === 'function'){;}else{;}};window.clearOutputAll = function(){try{const out = document.getElementById('resultOutput');if (out) out.innerHTML = '';window.clearOutputTable();if (ro && Array.isArray(ro.foundResults)){}refreshSelectAllState();notify('Output berhasil dihapus.','success');}catch(e){}};})();function showFormulaTableSection(){const label = document.getElementById('formulaTableLabel');const wrap = document.getElementById('formulaTableWrap');if (label) label.classList.remove('hidden');if (wrap) wrap.classList.remove('hidden');}function hideFormulaTableSection(clearRows){const label = document.getElementById('formulaTableLabel');const wrap = document.getElementById('formulaTableWrap');if (label) label.classList.add('hidden');if (wrap) wrap.classList.add('hidden');if (clearRows){const tbody = document.getElementById('resultTableBody');if (tbody) tbody.innerHTML = '';const selectAll = document.getElementById('selectAllRows');if (selectAll) selectAll.checked = false;}}function onRangkumClick(){try{rangkumRumus();}finally{showFormulaTableSection();}}function onStartSearchClick(){hideFormulaTableSection(true);startSearch();}function onContinueSearchClick(){hideFormulaTableSection(true);continueSearch();}document.addEventListener('DOMContentLoaded',function(){hideFormulaTableSection(false);});(function (){const WA_NUMBER = "6282306374484";const WA_TEXT = encodeURIComponent("Halo,saya ingin upgrade ke versi PRO Rumus Otomatis.");const WA_LINK = "https://wa.me/"+WA_NUMBER+"?text="+WA_TEXT;function notify(msg,type){try{if (typeof showNotification === "function"){showNotification(msg,type || "warning",5000);return;}}catch (e){}alert(msg);}function ensureProModal(){if (document.getElementById("proOverlay")) return;const style = document.createElement("style");style.textContent = ["#proOverlay{position:fixed;inset:0;z-index:99999;display:none;align-items:center;justify-content:center;background:rgba(15,23,42,.55);padding:16px}","#proOverlay .proCard{max-width:520px;width:100%;background:#0f172a;border:1px solid rgba(148,163,184,.25);border-radius:14px;box-shadow:0 18px 60px rgba(0,0,0,.35);padding:14px 14px 12px;color:#e2e8f0}","#proOverlay .proTitle{font-weight:900;font-size:14px;letter-spacing:.6px;text-align:center;margin:0 0 6px 0;white-space:normal;word-break:break-word}","#proOverlay .proSub{opacity:.88;text-align:center;font-size:12px;line-height:1.35;margin:0 0 12px 0;white-space:normal;word-break:break-word}","#proOverlay .proBtns{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}","#proOverlay .proBtn{display:inline-flex;align-items:center;justify-content:center;gap:6px;border:none;border-radius:10px;padding:10px 12px;font-weight:800;font-size:12px;cursor:pointer;text-decoration:none}","#proOverlay .proBtnWa{background:linear-gradient(135deg,#25D366,#128C7E);color:#071a12}","#proOverlay .proBtnClose{background:linear-gradient(135deg,#64748b,#475569);color:#fff}"].join("");document.head.appendChild(style);const overlay = document.createElement("div");overlay.id = "proOverlay";overlay.innerHTML ='<div class="proCard" role="dialog" aria-modal="true">'+'<div class="proTitle" id="proTitle"></div>'+'<div class="proSub" id="proSub"></div>'+'<div class="proBtns">'+'<a class="proBtn proBtnWa" id="proWaBtn" target="_blank" rel="noopener">üí¨ WA PRO</a>'+'<button class="proBtn proBtnClose" id="proCloseBtn" type="button">TUTUP</button>'+"</div>"+"</div>";document.body.appendChild(overlay);const close = () =>{overlay.style.display = "none";};overlay.addEventListener("click",(e) =>{if (e.target === overlay) close();});overlay.querySelector("#proCloseBtn").addEventListener("click",close);overlay.querySelector("#proWaBtn").setAttribute("href",WA_LINK);}function showProModal(title,sub){ensureProModal();const overlay = document.getElementById("proOverlay");const t = document.getElementById("proTitle");const s = document.getElementById("proSub");if (t) t.textContent = title || "FITUR PRO";if (s) s.textContent = sub || "Fitur ini hanya tersedia di versi PRO.";overlay.style.display = "flex";}const LIMITED_MISTIK = new Set(["ix","ml","mb","ty","m9"]);function attachProGuards(){const mistikInputs = Array.from(document.querySelectorAll('input[name="mistikExtra[]"]'));mistikInputs.forEach((el) =>{const id = String(el.getAttribute("data-mistik") || el.value || el.id || "").toLowerCase();if (!id) return;el.disabled = false;if (!LIMITED_MISTIK.has(id)){el.addEventListener("click",function (ev){ev.preventDefault();ev.stopPropagation();el.checked = false;showProModal("MISTIK "+id.toUpperCase(),"Fitur mistik "+id.toUpperCase()+" hanya tersedia di versi PRO.");},true);}});const triple = document.getElementById("enableTriple");if (triple){triple.disabled = false;triple.addEventListener("click",function (ev){if (triple.checked){ev.preventDefault();ev.stopPropagation();triple.checked = false;showProModal("3 KOMPONEN","Mode 3 komponen hanya tersedia di versi PRO.");}},true);}}document.addEventListener("DOMContentLoaded",attachProGuards);function getApp(){return window.RumusOtomatis || (typeof RumusOtomatis !== "undefined" ? RumusOtomatis : null);}function setValue(id,val){const el = document.getElementById(id);if (el) el.value = val;}function forceUncheck(id){const el = document.getElementById(id);if (el) el.checked = false;}function hookUiGuards(){const digitEl = document.getElementById("digitCount");if (digitEl){digitEl.disabled = false;const enforceMin4 = () =>{const val = parseInt(digitEl.value,10);if (!Number.isFinite(val) || val < 4){digitEl.value = "4";showProModal("DIGIT PREDIKSI PRO","Digit prediksi kurang dari 4 hanya tersedia di versi PRO.");}};digitEl.addEventListener("change",enforceMin4);digitEl.addEventListener("blur",enforceMin4);}const tripleEl = document.getElementById("enableTriple");if (tripleEl){tripleEl.addEventListener("click",() =>{if (tripleEl.checked){tripleEl.checked = false;showProModal("MODE 3 KOMPONEN","Mode 3 komponen hanya tersedia di versi PRO.");}});}const targetEl = document.getElementById("targetType");if (targetEl){targetEl.addEventListener("change",() =>{const v = String(targetEl.value || "").trim().toUpperCase();if (v !== "K" && v !== "E" && v !== "KE"){targetEl.value = "KE";showProModal("TARGET PRO TERKUNCI","Target ini hanya tersedia di versi PRO.");}});}const searchModeEl = document.getElementById("searchMode");if (searchModeEl){searchModeEl.addEventListener("change",() =>{const val = String(searchModeEl.value || "").trim().toLowerCase();if (val === "suffle"){searchModeEl.value = "urutan";showProModal("MODE SUFFLE","Mode Suffle (acak lengkap) hanya tersedia di versi PRO.");}});}const batchEl = document.getElementById("batchSize");if (batchEl){batchEl.addEventListener("change",() =>{const val = parseInt(batchEl.value,10);if (Number.isFinite(val) && val > 1000){batchEl.value = "1000";showProModal("BATCH SIZE PRO","Batch size di atas 1.000 hanya tersedia di versi PRO.");}});}const autoContinueEl = document.getElementById("autoContinue");if (autoContinueEl){autoContinueEl.addEventListener("click",(e) =>{if (autoContinueEl.checked){e.preventDefault();autoContinueEl.checked = false;showProModal("AUTO CONTINUE","Fitur Auto Continue hanya tersedia di versi PRO.");}});}const allowed = new Set(["ix","ml","mb","ty","m9"]);const nodes = document.querySelectorAll('#MistikCheckboxes input[type="checkbox"][name="mistikExtra[]"]');nodes.forEach((n) =>{const id = String(n.id || n.value || "").trim().toLowerCase();if (!allowed.has(id)){n.addEventListener("click",(e) =>{e.preventDefault();n.checked = false;showProModal("MISTIK "+id.toUpperCase(),"Mistik ini hanya tersedia di versi PRO.");});}});}function applyLimitedEngine(){return; const app = getApp();if (!app) return;app.mistikTables ={IX:{"0":"0","1":"1","2":"2","3":"3","4":"4","5":"5","6":"6","7":"7","8":"8","9":"9"},ML:{"0":"1","1":"2","2":"3","3":"4","4":"5","5":"6","6":"7","7":"8","8":"9","9":"0"},MB:{"0":"2","1":"3","2":"4","3":"5","4":"6","5":"7","6":"8","7":"9","8":"0","9":"1"},TY:{"0":"3","1":"4","2":"5","3":"6","4":"7","5":"8","6":"9","7":"0","8":"1","9":"2"},M9:{"0":"9","1":"0","2":"1","3":"2","4":"3","5":"4","6":"5","7":"6","8":"7","9":"8"}};const allowedM = new Set(["IX","ML","MB","TY","M9"]);app.getActiveMistikTables = function (){const selected = [];try{const nodes = document.querySelectorAll('#MistikCheckboxes input[type="checkbox"][name="mistikExtra[]"]');nodes.forEach((n) =>{if (n && n.checked){const v = String(n.value || n.getAttribute("data-mistik") || n.id || "").trim().toUpperCase();if (v && allowedM.has(v) && this.mistikTables[v]) selected.push(v);}});}catch (e){}return selected.filter((k,i) => selected.indexOf(k) === i);};app.getTargetTypeName = function (t){const x = String(t || "").toUpperCase();if (x === "K") return "KEPALA";if (x === "E") return "EKOR";if (x === "KE") return "2D BELAKANG (K/E)";return "PRO";};app.getTargetDigits = function (next4d,targetType){const s = String(next4d || "");if (s.length !== 4) return "";const t = String(targetType || "").toUpperCase();if (t === "K") return s.charAt(2);if (t === "E") return s.charAt(3);if (t === "KE") return s.slice(2,4);return "";};app.checkPrediction = function (predictionDigits,next4d,targetType){const s = String(next4d || "");if (s.length !== 4) return false;const pred = String(predictionDigits || "");const t = String(targetType || "").toUpperCase();const k = s.charAt(2);const e = s.charAt(3);if (t === "K") return pred.indexOf(k) !== -1;if (t === "E") return pred.indexOf(e) !== -1;if (t === "KE") return pred.indexOf(k) !== -1 || pred.indexOf(e) !== -1;return false;};const oldRangkum = window.onRangkumClick;window.onRangkumClick = function (){try{if (typeof oldRangkum === "function") oldRangkum();}catch (e){}const label = document.getElementById("formulaTableLabel");const wrap = document.getElementById("formulaTableWrap");const body = document.getElementById("resultTableBody");if (label) label.classList.remove("hidden");if (wrap) wrap.classList.remove("hidden");if (body){body.innerHTML = "";const tr = document.createElement("tr");const td = document.createElement("td");td.colSpan = 6;td.style.textAlign = "center";td.style.padding = "14px 10px";td.innerHTML ='<div style="display:inline-block;max-width:520px;width:100%;background:rgba(30,41,59,.95);border:1px solid rgba(148,163,184,.25);border-radius:12px;padding:12px 12px;color:#e2e8f0;line-height:1.35;word-break:break-word;">'+'<div style="font-weight:900;font-size:12px;letter-spacing:.6px;margin-bottom:6px;">üîí RANGKUM RUMUS (PRO)</div>'+'<div style="font-size:12px;opacity:.95;">Tabel rangkum rumus tersedia di versi PRO. Upgrade untuk membuka detail rumus dan tombol salin otomatis.</div>'+'</div>';tr.appendChild(td);body.appendChild(tr);}};;const batchEl = document.getElementById("batchSize");if (batchEl) batchEl.value = "1000";app.BATCH_SIZE = 1000;const searchModeEl = document.getElementById("searchMode");if (searchModeEl) searchModeEl.value = "urutan";}document.addEventListener("DOMContentLoaded",function (){hookUiGuards();});})();(function(){const oldRangkum = window.onRangkumClick;window.onRangkumClick = function (){try{if (typeof oldRangkum === "function") oldRangkum();}catch (e){}const label = document.getElementById("formulaTableLabel");const wrap = document.getElementById("formulaTableWrap");const body = document.getElementById("resultTableBody");if (label) label.classList.remove("hidden");if (wrap) wrap.classList.remove("hidden");if (body){body.innerHTML = "";const tr = document.createElement("tr");const td = document.createElement("td");td.colSpan = 6;td.style.textAlign = "center";td.style.padding = "14px 10px";td.innerHTML ='<div style="display:inline-block;max-width:520px;width:100%;background:rgba(30,41,59,.95);border:1px solid rgba(148,163,184,.25);border-radius:12px;padding:12px 12px;color:#e2e8f0;line-height:1.35;word-break:break-word;">'+'<div style="font-weight:900;font-size:12px;letter-spacing:.6px;margin-bottom:6px;">üîí RANGKUM RUMUS (PRO)</div>'+'<div style="font-size:12px;opacity:.95;">Tabel rangkum rumus tersedia di versi PRO. Upgrade untuk membuka detail rumus dan tombol salin otomatis.</div>'+'</div>';tr.appendChild(td);body.appendChild(tr);}if (typeof showProModal === "function"){showProModal("RANGKUM RUMUS (PRO)","Fitur rangkum rumus lengkap hanya tersedia di versi PRO.");}};})();(function(){function ensureLockedOutput(){const box = document.getElementById('resultOutput');if(!box) return;box.innerHTML ='<div style="display:inline-block;max-width:720px;width:100%;background:rgba(30,41,59,.96);border:1px solid rgba(148,163,184,.25);border-radius:14px;padding:14px 14px;color:#e2e8f0;line-height:1.4;word-break:break-word;">'+'<div style="font-weight:900;font-size:12px;letter-spacing:.7px;margin-bottom:8px;">üîí OUTPUT LENGKAP (PRO)</div>'+'<div style="font-size:12px;opacity:.95;margin-bottom:10px;">Hasil rumus lengkap (format markdown / detail) dikunci di versi PRO.</div>'+'<div style="font-size:12px;opacity:.95;margin-bottom:10px;">Buka PRO untuk mendapatkan:</div>'+'<ul style="margin:0 0 12px 18px;padding:0;font-size:12px;opacity:.95;">'+'<li>Output rumus lengkap+tombol salin otomatis</li>'+'<li>Semua target (A/C/AC/CK/CB/J/JS dan lainnya)</li>'+'<li>Mode 3 komponen</li>'+'<li>Semua mistik (M0‚ÄìM10)</li>'+'<li>Shuffle & sesi/batch besar</li>'+'</ul>'+'<div style="display:flex;gap:10px;flex-wrap:wrap;">'+'<a href="https://wa.me/6282306374484" target="_blank" rel="noopener" style="text-decoration:none;display:inline-flex;align-items:center;justify-content:center;padding:10px 12px;border-radius:12px;background:#16a34a;color:white;font-weight:900;font-size:12px;">üí¨ WA PRO</a>'+'<button type="button" id="__openProModalOutput" style="cursor:pointer;display:inline-flex;align-items:center;justify-content:center;padding:10px 12px;border-radius:12px;border:1px solid rgba(148,163,184,.35);background:rgba(15,23,42,.55);color:#e2e8f0;font-weight:900;font-size:12px;">Lihat Detail</button>'+'</div>'+'</div>';const btn = document.getElementById('__openProModalOutput');if(btn){btn.onclick = function(){if(typeof window.showProModal === 'function'){window.showProModal('OUTPUT LENGKAP (PRO)','Fitur PRO: Output rumus lengkap (markdown/detail),semua target,mode 3 komponen,semua mistik (M0‚ÄìM10),shuffle,batch besar,dan tombol salin otomatis.');}else{alert('Output lengkap hanya tersedia di versi PRO.');}};}}function lockEngineOutput(){const RO = (typeof window.RumusOtomatis !== 'undefined' ? window.RumusOtomatis : null);if(!RO) return;RO.deferDetailedOutput = true;RO._finalOutputBuffer = [];RO.setResultPlain = function(){ensureLockedOutput();};RO.appendResultPlain = function(){};RO.flushFinalOutputPartial = function(){this._finalOutputBuffer = []; ensureLockedOutput();};RO.flushFinalOutput = function(){this._finalOutputBuffer = []; ensureLockedOutput();};immediatelyensureLockedOutput();}document.addEventListener('DOMContentLoaded',function(){try{lockEngineOutput();}catch(e){}setTimeout(function(){try{lockEngineOutput();}catch(e){}},50);});})();(function(){let outputState = 'empty';function showEmptyOutput(kind){const __boxEl = document.getElementById('resultOutput');if(__boxEl){__boxEl.classList.add('output-mode-empty'); __boxEl.classList.remove('output-mode-locked');}const box = document.getElementById('resultOutput');if(!box) return;outputState = 'empty';const icon = kind === 'deleted' ? 'üóëÔ∏è':'üìã';const msg = kind === 'deleted'? 'Semua data telah dihapus.<br>Masukkan data baru dan mulai pencarian.': 'Belum ada hasil.<br>Klik <strong>CARI RUMUS</strong> untuk memulai pencarian.';box.innerHTML ='<div class="output-empty-state">'+'<div class="output-empty-card">'+'<div class="output-empty-icon">'+icon+'</div>'+'<div class="output-empty-text">'+msg+'</div>'+'</div>'+'</div>';}function showLockedOutput(){const __boxEl = document.getElementById('resultOutput');if(__boxEl){__boxEl.classList.add('output-mode-locked'); __boxEl.classList.remove('output-mode-empty');}const box = document.getElementById('resultOutput');if(!box) return;outputState = 'locked';const waText = encodeURIComponent('Halo,saya ingin upgrade ke versi PRO Rumus Otomatis untuk mendapatkan output lengkap dan fitur premium lainnya.');box.innerHTML ='<div class="locked-output-wrapper">'+'<div class="locked-output-card">'+'<div class="locked-output-icon">üîí</div>'+'<div class="locked-output-title">OUTPUT LENGKAP (PRO)</div>'+'<div class="locked-output-subtitle">'+'Hasil rumus lengkap dengan format markdown</br>dan detail prediksi hanya tersedia di versi PRO.'+'</div>'+'<div class="locked-output-features">'+'<div class="locked-output-features-title">‚≠ê Fitur PRO yang Anda Dapatkan:</div>'+'<ul>'+'<li>Output rumus lengkap+detail prediksi per hari</li>'+'<li>Format markdown rapi,mudah dibaca & disalin</li>'+'<li>Semua target prediksi (A/C/AC/CK/CB/J/JS<br/>dan lainnya)</li>'+'<li>Mode 3 kombinasi untuk formula lebih kompleks</li>'+'<li>Semua tabel mistik (M0 sampai M10)</li>'+'<li>Mode shuffle untuk pengujian acak menyeluruh</li>'+'<li>Batch size hingga 5 juta kombinasi per sesi</li>'+'<li>Tombol salin otomatis untuk kemudahan</li>'+'</ul>'+'</div>'+'<div class="locked-output-cta">'+'<a href="https://wa.me/6282306374484?text='+waText+'" target="_blank" rel="noopener" class="locked-output-btn locked-output-btn-wa">'+'<span>üí¨</span><span>UPGRADE VIA WHATSAPP</span>'+'</a>'+'</div>'+'<div class="locked-output-footer">Hubungi WA untuk akses versi PRO</div>'+'</div>'+'</div>';const btn = document.getElementById('__showProDetails');if(btn){btn.onclick = function(){if(typeof window.showProModal === 'function'){window.showProModal('FITUR PRO LENGKAP','Versi PRO membuka output lengkap (markdown+detail prediksi),semua target (A/C/AC/CK/CB/J/JS/Shio/GG/BK/Lemah),mode 3 komponen,semua mistik (M0-M10),mode shuffle,batch hingga 5 juta,tombol salin otomatis,dan optimasi performa.');}};}}function lockEngineOutput(){const RO = (typeof window.RumusOtomatis !== 'undefined' ? window.RumusOtomatis : null);if(!RO) return;const wrap = (obj,name,fn) =>{const orig = obj[name];obj[name] = fn(orig);};if(typeof RO.setResultPlain === 'function'){wrap(RO,'setResultPlain',(orig)=>function(){if(this.isSearching){showEmptyOutput(); return;}if(!this.isSearching && this.foundResults && this.foundResults.length > 0){showLockedOutput(); return;}showEmptyOutput();});}if(typeof RO.appendResultPlain === 'function'){wrap(RO,'appendResultPlain',(orig)=>function(){return;});}if(typeof RO.appendResultHTML === 'function'){wrap(RO,'appendResultHTML',(orig)=>function(){return;});}if(typeof RO.flushFinalOutputPartial === 'function'){wrap(RO,'flushFinalOutputPartial',(orig)=>function(){try{this._finalOutputBuffer = [];}catch(e){}if(!this.isSearching && this.foundResults && this.foundResults.length > 0){showLockedOutput();}else{showEmptyOutput();}});}if(typeof RO.flushFinalOutput === 'function'){wrap(RO,'flushFinalOutput',(orig)=>function(){try{this._finalOutputBuffer = [];}catch(e){}if(!this.isSearching && this.foundResults && this.foundResults.length > 0){showLockedOutput();}else{showEmptyOutput();}});}if(typeof RO.startSearch === 'function'){wrap(RO,'startSearch',(orig)=>function(){showEmptyOutput();return orig ? orig.apply(this,arguments) : undefined;});}if(typeof RO.finishSearch === 'function'){wrap(RO,'finishSearch',(orig)=>function(){const r = orig ? orig.apply(this,arguments) : undefined;setTimeout(function(){const R2 = window.RumusOtomatis;if(R2 && R2.foundResults && R2.foundResults.length > 0){showLockedOutput();}else{showEmptyOutput();}},120);return r;});}if(typeof RO.stopSearch === 'function'){wrap(RO,'stopSearch',(orig)=>function(){const r = orig ? orig.apply(this,arguments) : undefined;setTimeout(function(){const R2 = window.RumusOtomatis;if(R2 && R2.foundResults && R2.foundResults.length > 0){showLockedOutput();}else{showEmptyOutput();}},120);return r;});}if(typeof RO.clearOutput === 'function'){RO.clearOutput = function(){if(this.isSearching){if(typeof this.showNotification === 'function'){this.showNotification('Hentikan proses terlebih dahulu!','warning');}return;}if(!confirm('Hapus semua hasil output?')) return;showEmptyOutput('cleared');if(typeof this.showNotification === 'function'){this.showNotification('Output telah dihapus.','info');}};}if(typeof RO.clearAllData === 'function'){wrap(RO,'clearAllData',(orig)=>function(){const r = orig ? orig.apply(this,arguments) : undefined;setTimeout(function(){showEmptyOutput('deleted');},0);return r;});}showEmptyOutput();}document.addEventListener('DOMContentLoaded',function(){showEmptyOutput();try{lockEngineOutput();}catch(e){}setTimeout(function(){try{lockEngineOutput();}catch(e){}},50);});})();</script></body></html>
